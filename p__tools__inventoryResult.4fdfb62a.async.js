"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7998],{64082:function(Q,N,e){var O=e(48651),a=e.n(O),I=e(38046),g=e.n(I),j=e(30541),l=e(33421),D=e(68591),P=e.n(D),h=e(63342),d=["className"];function n(M){var A=M.className,u=g()(M,d),S=(0,l.l)(function(x){var c=x.token;return{".ant-page-header":{padding:"1rem 1.5rem",backgroundColor:c.colorBgBase,".ant-breadcrumb":{fontSize:".875rem",paddingBlockStart:"0 !important"},".ant-page-header-heading-title":{fontSize:"1.25rem"}},".ant-pro-grid-content":{padding:"1.5rem",backgroundColor:"transparent",".ant-pro-page-container-children-content":{padding:0,paddingBlock:"0 !important"},".ant-pro-page-container-children-container":{paddingBlock:"0 !important",paddingInline:"0 !important"}}}});return(0,h.jsx)(j._z,a()({className:P()(A,S)},u))}N.Z=n},9991:function(Q,N,e){e.d(N,{u:function(){return A},z:function(){return M}});var O=e(48651),a=e.n(O),I=e(38046),g=e.n(I),j=e(68591),l=e.n(j),D=e(68717),P=e(31887),h=e(63342),d=["children","className"],n=["busy","type","className","defStyle","children"];function M(u){var S=u.children,x=u.className,c=g()(u,d);return(0,h.jsx)("button",a()(a()({},c),{},{className:l()(x),children:u.children}))}function A(u){var S=u.busy,x=u.type,c=x===void 0?"primary":x,T=u.className,z=u.defStyle,X=z===void 0?"btn-primary":z,V=u.children,$=g()(u,n);return(0,h.jsx)(P.ZP,a()(a()({type:X==="btn-primary-1"?"default":c,className:l()(T,"leading-none !shadow-none",{})},$),{},{children:S?(0,h.jsx)(D.fCD,{className:"animate-spin mx-auto"}):V}))}},2042:function(Q,N,e){e.d(N,{n:function(){return g},s:function(){return I}});var O=e(97207),a=e.n(O);function I(j){var l=a().groupBy(j,"flowId"),D=function P(h){h.forEach(function(d){if(d._child||(d._child=(d.childFlowIds||[]).map(function(M){return l[M][0]}),P(d._child)),d._child.length===0)d._depth=0;else{var n;d._depth=(((n=a().maxBy(d._child,"_depth"))===null||n===void 0?void 0:n._depth)||0)+1}})};D(j)}var g=function(l,D){var P=typeof l=="string"?[l]:l;return!!a().find(P,function(h){return h.startsWith(D)})}},83556:function(Q,N,e){e.r(N),e.d(N,{default:function(){return De}});var O=e(22786),a=e.n(O),I=e(46299),g=e.n(I),j=e(86516),l=e.n(j),D=e(64082),P=e(48651),h=e.n(P),d=e(42586),n=e(63342);function M(y){return(0,n.jsx)(d.Z,h()({opts:{locale:"en"},notMerge:!0,lazyUpdate:!0},y))}var A=e(9991),u=e(11e3),S=e(25777),x=e(54916),c=e(2042),T=e(81123),z=e(12564),X=e(68591),V=e.n(X),$=e(97207),v=e.n($),L=e(79685),ge=e(5490),xe=e(18812);function q(y){var W=y.children,B=y.tit,ee=y.className;return(0,n.jsxs)("div",{className:V()("for2pdf-item flex w-full flex-col bg-white min-h-[6.25rem] border-t-[3px] border-solid border-green-2",ee),style:{boxShadow:"0px 2px 10px 0px rgba(26, 62, 31, 0.10)"},children:[(0,n.jsx)("div",{className:"w-full h-[4.1875rem] flex justify-center items-center text-xl font-semibold text-black",style:{background:"linear-gradient(180deg, rgba(41, 149, 58, 0.12) 0%, rgba(41, 149, 58, 0) 100%)"},children:B}),W]})}function F(y){var W=y.tit,B=y.value;return(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("div",{className:"flex gap-2.5 items-center text-green-2 text-base",children:[(0,n.jsx)("div",{className:"w-1 h-1 shrink-0 rounded-sm bg-green-2 overflow-hidden"}),(0,n.jsx)("span",{className:"whitespace-nowrap",children:W})]}),(0,n.jsx)("div",{className:"text-base text-gray-6 text-right",children:B})]})}function ye(){var y=(0,z.useSearchParams)(),W=l()(y,1),B=W[0],ee=(0,L.useState)(!1),de=l()(ee,2),ie=de[0],ce=de[1],Pe=(0,L.useState)(),me=l()(Pe,2),k=me[0],Be=me[1],Ce=(0,L.useState)(!0),fe=l()(Ce,2),be=fe[0],Ne=fe[1],Me=function(){var C=g()(a()().mark(function f(){var s,i,m;return a()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(B.get("id")){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,(0,x.fF)(B.get("id"));case 4:if(s=r.sent,s){r.next=7;break}return r.abrupt("return");case 7:return r.next=9,(0,x.Yp)(s.modelId);case 9:i=r.sent,m=i.modelBomInfo,Be({lca:s,bominfo:m}),Ne(!1);case 13:case"end":return r.stop()}},f)}));return function(){return C.apply(this,arguments)}}();(0,L.useEffect)(function(){Me()},[B.get("id")]);var ne=(0,L.useMemo)(function(){var C=[],f="",s=["",""],i={};if(k){var m=k.lca,p=k.bominfo,r=(0,T.OA)(m.lcaResult);if(r){var Z,E,re,te,ae,oe,ve=(((Z=r.extra)===null||Z===void 0?void 0:Z.targetAmount)||"").split("Item(s)");C={productSystemName:(E=r.extra)===null||E===void 0?void 0:E.productSystemName,methodName:(re=r.extra)===null||re===void 0?void 0:re.methodName,targetName:ve[1]||((te=r.extra)===null||te===void 0?void 0:te.productSystemName),targetAmount:"".concat(Math.round(ve[0]||1)," (\u4EF6)"),calculateSuccessTime:m.calculateSuccessTime,loadNumber:m.loadNumber,loadName:m.loadName},f=r.totalImpacts&&((ae=r.totalImpacts[0])===null||ae===void 0?void 0:ae.impact.referenceUnit)||"";var Ae=v().round(r.totalResult||((oe=r.treeNode)===null||oe===void 0?void 0:oe.result)||0,2);s=["".concat(Ae||0),f]}var Y=(0,T.OA)(p),pe=(0,T.OA)(m.lcaTagResult);if(Y&&pe){var H=v().groupBy(pe,"flowId"),Se=v().groupBy(Y,"flowId");(0,c.s)(Y);var Re=Y;i={padding:20,tooltip:{trigger:"item",formatter:function(o){var _="".concat(o.name," ").concat(o.value,"(").concat(f,")");return o.marker?"".concat(o.marker," ").concat(_):_}},series:{type:"sankey",data:[],links:[]}};var Te=function(o){return(0,c.n)(o.tagType,"STAGE01")?"\u4F7F\u7528\u73AF\u8282":(0,c.n)(o.tagType,"STAGE02")?"\u8FD0\u8F93\u9500\u552E\u73AF\u8282":(0,c.n)(o.tagType,"STAGE03")?"\u751F\u4EA7\u5236\u9020\u73AF\u8282":""},Le=function(o){if((0,c.n)(o.tagType,"REFERENCE"))return"\u4F7F\u7528\u73AF\u8282";if((0,c.n)(o.tagType,"STAGE")){if(o._depth===1)return"\u751F\u4EA7\u5236\u9020\u73AF\u8282";if(o._depth===2)return"\u8FD0\u8F93\u9500\u552E\u73AF\u8282"}return""},R={};Re.forEach(function(t){var o;(0,c.n)(t.tagType,"REFERENCE")&&(C.targetName=t.flowName);var _=i.series.links,b=i.series.data,Ee=((o=v().first(H[t.flowId]))===null||o===void 0?void 0:o.result)||0;R[t.flowName]||(R[t.flowName]=!0,b==null||b.push({name:t.flowName,value:v().round(Ee,2),depth:t._depth})),t.childFlowIds&&t.childFlowIds.length&&t.childFlowIds.forEach(function(J){var G=v().first(H[J]),le=v().first(Se[J]);if(le&&G){var ue=v().first(H[le.flowId]),Fe=v().round((ue==null?void 0:ue.result)||0,2);_==null||_.push({target:t.flowName,source:le.flowName,value:Fe})}});var se=v().round(Ee-v().sumBy(t.childFlowIds||[],function(J){var G;return(G=H[J][0])===null||G===void 0?void 0:G.result}),2),K=Te(t);if(K&&t._depth>0)R[K]||(R[K]=!0,b==null||b.push({name:K,depth:t._depth-1})),_==null||_.push({target:t.flowName,source:K,value:se});else if(se>0&&t._depth>0){var w=Le(t);w&&(R[w]||(R[w]=!0,b==null||b.push({name:w,depth:t._depth-1})),_==null||_.push({target:t.flowName,source:w,value:se}))}})}}return{generalInfo:C,carbonResult:s,chartData:i}},[k]),U=ne.generalInfo,_e=ne.carbonResult,he=ne.chartData,Oe=function(){var C=g()(a()().mark(function f(){var s,i,m,p,r;return a()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!(!B.get("id")||ie)){E.next=2;break}return E.abrupt("return",!1);case 2:return ce(!0),E.next=5,(0,x.LW)(B.get("id"));case 5:s=E.sent,s.headers&&(i=s.headers.get("content-disposition"),i&&(m=i.match(/filename=(.+)/),m&&(ce(!1),p=new Blob([s.data]),r=document.createElement("a"),r.download=m[1],r.style.display="none",r.href=URL.createObjectURL(p),document.body.appendChild(r),r.click(),URL.revokeObjectURL(r.href),document.body.removeChild(r))));case 7:case"end":return E.stop()}},f)}));return function(){return C.apply(this,arguments)}}(),Ie=function(){var C=g()(a()().mark(function f(){var s,i;return a()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(s=document.getElementById("inventory-result-content"),s){p.next=3;break}return p.abrupt("return");case 3:i="PCF-".concat(U.loadName,".pdf"),(0,ge.YM)(s).then(function(r){return xe.createPdf({content:[{image:r,width:515}]})}).then(function(r){return r.download(i)}).catch(console.error);case 5:case"end":return p.stop()}},f)}));return function(){return C.apply(this,arguments)}}();return(0,n.jsx)(D.Z,{title:"\u78B3\u8DB3\u8FF9\u7ED3\u679C",className:"text-lg text-black",extra:[(0,n.jsx)(A.u,{className:"w-[142px]",onClick:Ie,children:"\u5C06\u6B64\u9875\u9762\u751F\u6210PDF"},"key_export_pdf"),(0,n.jsx)(A.u,{className:"w-[149px]",onClick:Oe,busy:ie,children:"\u5BFC\u51FA\u8BA1\u7B97\u660E\u7EC6Excel"},"key_export_excel")],children:be?(0,n.jsx)("div",{className:"h-[100vh] w-full items-center",children:(0,n.jsx)(u.g,{})}):(0,n.jsx)("div",{className:"mo:break-all max-w-[1200px]",id:"inventory-result-content",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-5 mo:grid-cols-1",children:[(0,n.jsx)(q,{tit:"\u4EA7\u54C1\u78B3\u8DB3\u8FF9",children:(0,n.jsxs)("div",{className:"flex items-center flex-1 px-9 mb-9",children:[(0,n.jsx)(S.vD,{}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col justify-center items-center whitespace-nowrap",children:[(0,n.jsx)("span",{className:"font-semibold text-green-2 text-4xl",children:_e[0]}),(0,n.jsx)("span",{className:"font-semibold text-black text-base",children:_e[1]})]})]})}),(0,n.jsx)(q,{tit:"\u78B3\u8DB3\u8FF9\u8BC4\u4EF7\u8BE6\u60C5",children:(0,n.jsxs)("div",{className:"flex flex-col gap-3 mx-5 mt-3 mb-9",children:[(0,n.jsx)(F,{tit:"\u76EE\u6807\u4EA7\u54C1",value:U.targetName}),(0,n.jsx)(F,{tit:"\u76EE\u6807\u4EA7\u54C1\u6570\u91CF",value:U.targetAmount}),(0,n.jsx)(F,{tit:"\u78B3\u8DB3\u8FF9\u6279\u6B21",value:U.loadName}),(0,n.jsx)(F,{tit:"\u73AF\u5883\u5F71\u54CD\u8BC4\u4EF7\u65B9\u6CD5",value:"IPCC 2021,GWP 100"}),(0,n.jsx)(F,{tit:"\u8BA1\u7B97\u7ED3\u679C\u751F\u6210\u65F6\u95F4",value:U.calculateSuccessTime})]})}),(0,n.jsx)(q,{tit:"\u751F\u547D\u5468\u671F\u73AF\u8282\u660E\u7EC6\u7ED3\u679C",className:"col-span-2 mo:col-span-1",children:he&&(0,n.jsx)(M,{className:"w-full !h-[360px]",option:he})})]})})})}var je=ye,De=je}}]);
