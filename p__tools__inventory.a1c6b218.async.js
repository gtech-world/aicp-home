"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[9725],{75631:function(st,z,t){t.r(z),t.d(z,{default:function(){return Mt}});var b=t(48651),v=t.n(b),G=t(86516),d=t.n(G),H=t(5677),a=t.n(H),x=t(64082),u=t(18842),F=t(9991),J=t(5053),at=t(8965),rt=t(76222),C=t(12564),P=t(68591),ot=t.n(P),n=t(79685),ft=t(22786),ct=t.n(ft),pt=t(46299),xt=t.n(pt),mt=t(95968),lt=t(54916),Q=t(81123),ht=t(48294),e=t(63342),gt=function(h){var s=h.onOpenModal,R=h.realData,g=h.tableData,D=h.realArr,Y=(0,n.useState)(g),A=d()(Y,2),k=A[0],O=A[1],q=function(){for(var r,f=(r=document)===null||r===void 0?void 0:r.getElementById("realDataTable"),y=f.getElementsByTagName("tr"),N=[],w=0;w<y.length;w++){for(var L=[],U=y[w].getElementsByTagName("input"),V=0;V<U.length;V++){var K=U[V].value;L.push(K)}N.push(L)}var m=[];m=g==null?void 0:g.map(function(i,o){var S={processId:i.context["@id"],paramValue:N.slice(1)[o][0]||i.value.toString(),paramName:i.name,dateTime:(0,Q.p6)()};return S});var l={lcaParamList:m};typeof s=="function"&&s(),typeof R=="function"&&R(l)};(0,n.useEffect)(function(){var c=g==null?void 0:g.map(function(r,f){var y;return D!=null&&D.length&&((y=D[f])===null||y===void 0?void 0:y.paramName)===r.name?v()(v()({},r),{},{inputValue:D[f].paramValue}):v()({},r)});O(c)},[D,g]);var Z=[{title:"\u53C2\u6570\u540D",dataIndex:"name",width:"9rem",render:function(r){return(0,e.jsx)("div",{className:" flex items-center h-[33px] font-normal leading-[21px] text-[14px] ",children:r})}},{title:"\u8FC7\u7A0B\u540D\u79F0",dataIndex:"name",width:"7rem",render:function(r,f){return(0,e.jsx)("div",{className:"flex items-center  h-[33px] font-normal leading-[21px] text-[14px] ",children:f.context.name})}},{title:"\u53C2\u8003\u503C",width:"10rem",dataIndex:"value",render:function(r){return(0,e.jsx)("div",{className:"flex items-center h-[33px] font-normal leading-[21px] text-[14px] ",children:r})}},{title:"\u586B\u5165\u503C",width:"10rem",dataIndex:"createTime",render:function(r,f){return(0,e.jsx)("input",{defaultValue:f.inputValue,type:"number",className:"font-normal  leading-[21px] text-[14px] w-[10rem] h-[33px] "})}}];return(0,e.jsx)(mt.u_,{title:"\u5B9E\u666F\u6570\u636E\u586B\u62A5",containerClassName:"mx-5 max-w-[640px]",titleClassName:"text-[16px] leading-5 font-bold",onClose:typeof s=="function"&&s||void 0,line:!0,bottomBtn:(0,e.jsx)("div",{className:"mx-5 ",children:(0,e.jsxs)("div",{className:"flex flex-row justify-between gap-5 ",children:[(0,e.jsx)(F.u,{size:"large",onClick:typeof s=="function"&&s||void 0,defStyle:"btn-primary-1",className:"flex-1  font-normal  h-[50px] border-2 text-[18px]",children:"\u53D6\u6D88"}),(0,e.jsx)(F.u,{size:"large",className:"flex-1 h-[50px]  font-normal  text-[18px]",onClick:q,children:"\u786E\u5B9A"})]})}),children:(0,e.jsx)("div",{className:" mx-5 w-[640px] max-h-[400px] overflow-y-auto ",children:(0,e.jsx)(ht.i,{columns:Z,tableId:"realDataTable",data:k||[],isSetBorder:!0,maxHeight:"calc(100vh - 270px)",headerClassName:{background:"#FAFAFA",position:"sticky",top:0,fontWeight:"700",fontSize:"18px",lineHeight:"30px",height:"50px"}})})})},Dt=gt,yt=t(46284),Nt=t(3826),St=t(7698),It={loadName:"",productId:""},Ct=function(h){var s=h.openResultModal,R=h.getList,g=(0,n.useState)(!1),D=d()(g,2),Y=D[0],A=D[1],k=(0,n.useState)([{name:"",id:""}]),O=d()(k,2),q=O[0],Z=O[1],c=(0,n.useState)({lcaParamList:[]}),r=d()(c,2),f=r[0],y=r[1],N=(0,n.useState)([]),w=d()(N,2),L=w[0],U=w[1],V=(0,n.useState)(It),K=d()(V,2),m=K[0],l=K[1],i=(0,n.useState)(!0),o=d()(i,2),S=o[0],$=o[1],I=function(){(0,lt.ev)().then(function(p){Z(p||{name:"",id:""}),$(!1)}).catch(function(p){}).finally()},j=function(){var p,M=m.loadName,B=m.productId;if(!(!M||!B)){var tt=L==null?void 0:L.map(function(et){return{processId:et.context["@id"],paramValue:et.value.toString(),paramName:et.name,dateTime:(0,Q.p6)()}}),T=(p=f.lcaParamList)!==null&&p!==void 0&&p.length?f:{lcaParamList:tt.length?tt:void 0},Ft=v()(v()({},T),{},{loadName:M,productId:B});(0,lt.E)(Ft).then(function(et){typeof R=="function"&&R()}).catch(function(et){}).finally(function(){typeof s=="function"&&s()})}};(0,n.useEffect)(function(){I()},[]);var ut=function(){m.productId&&A(!0)},nt=function(p,M){l(function(B){return v()(v()({},B),{},a()({},M,p))})},it=function(){var E=xt()(ct()().mark(function p(){return ct()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:(0,lt.NF)(m.productId).then(function(tt){var T=JSON.parse(tt.paramDetail)[0]||[];U(JSON.stringify(T)==="{}"||!(T!=null&&T.parameters)?[]:T==null?void 0:T.parameters)}).catch(function(tt){}).finally();case 1:case"end":return B.stop()}},p)}));return function(){return E.apply(this,arguments)}}();(0,n.useEffect)(function(){m.productId&&it()},[m.productId]);var dt={loadName:"",productId:"",realDataInput:""},Tt=[{label:"\u78B3\u8DB3\u8FF9\u6279\u6B21",dataIndex:"loadName",render:function(){return(0,e.jsx)(Nt.Z,{value:m.loadName,onChange:function(M){return nt(M.target.value,"loadName")},id:"loadName",name:"loadName",maxLength:30,style:{marginTop:"-5px"},className:"w-full mb-[20px] px-5 border border-[#DDDDDD]  h-[40px]  bg-[#F8F8F8] rounded-lg"})}},{label:"\u4EA7\u54C1\u7CFB\u7EDF",dataIndex:"productId",render:function(){return(0,e.jsx)(St.default,{value:m.productId,style:{height:"40px",borderColor:"#DDDDDD",backgroundColor:"#F8F8F8",width:"100%",marginTop:"-5px"},onChange:function(M){return nt(M,"productId")},options:(0,Q.ry)("name","id",q)})}},{label:"\u5B9E\u666F\u6570\u636E\u586B\u62A5",dataIndex:"realDataInput",render:function(){return(0,e.jsx)("div",{onClick:function(){return ut()},className:" flex cursor-pointer rounded-[4px] leading-4 text-[14px]  mt-[-5px] bg-[#F1F1F1] w-[84px] h-[24px]  text-center items-center justify-center ",children:"\u524D\u5F80\u586B\u5199"})}}];return S?null:(0,e.jsxs)(n.Fragment,{children:[(0,e.jsx)(mt.u_,{className:"rounded-lg",containerClassName:"mx-5 w-[640px]",titleClassName:"text-[20px] leading-5 font-bold",title:"\u65B0\u5EFA\u78B3\u8DB3\u8FF9\u7ED3\u679C",onClose:s,line:!0,bottomBtn:(0,e.jsxs)("div",{className:"flex flex-row justify-between gap-5 ",children:[(0,e.jsx)(F.u,{size:"large",onClick:s,defStyle:"btn-primary-1",className:"flex-1  font-normal  h-[50px] border-2 text-[18px]",children:"\u53D6\u6D88"}),(0,e.jsx)(F.u,{size:"large",className:"flex-1 h-[50px]  font-normal  text-[18px]",onClick:j,disabled:!m.productId||!m.loadName,children:"\u8BA1\u7B97\u78B3\u7ED3\u679C"})]}),children:(0,e.jsx)("div",{className:"mx-5 w-[640px] ",children:(0,e.jsx)(yt.Z,{size:"small",options:Tt,data:dt,optionEmptyText:"-",layout:"vertical",column:1,contentStyle:{color:"#999999",fontWeight:"400"},labelStyle:{color:"#000000",fontWeight:"400"}})})}),Y&&(0,e.jsx)(Dt,{realData:y,tableData:L,realArr:f.lcaParamList,onOpenModal:function(){return A(!1)}})]})},jt=Ct,W,vt=(W={},a()(W,-1,{color:"text-[red]",text:"\u8BA1\u7B97\u5931\u8D25"}),a()(W,0,{color:"text-[#FF9800]",text:"\u7B49\u5F85\u8BA1\u7B97"}),a()(W,1,{color:"text-green-2",text:"\u67E5\u770B\u7ED3\u679C"}),a()(W,2,{color:"text-blue-600",text:"\u6B63\u5728\u8BA1\u7B97"}),W);function Lt(){var X=(0,n.useState)(1),h=d()(X,2),s=h[0],R=h[1],g=(0,n.useState)(!1),D=d()(g,2),Y=D[0],A=D[1],k=(0,n.useState)(!1),O=d()(k,2),q=O[0],Z=O[1],c=(0,n.useRef)({inputData:"",data:""}),r=function(i){var o=i.param,S=i.paramDetail;c.current={inputData:o,data:S},Z(!0)},f=(0,n.useMemo)(function(){return[{title:"\u78B3\u8DB3\u8FF9\u6279\u6B21",dataIndex:"loadName",width:180,ellipsis:!0},{title:"\u5B9E\u666F\u6570\u636E",valueType:"option",width:120,render:function(i,o){return[(0,e.jsx)("div",{className:"flex justify-center whitespace-nowrap px-2.5 bg-[#F1F1F1] rounded",onClick:function(){return r(o)},children:(0,e.jsx)("span",{className:"cursor-pointer",children:"\u67E5\u770B\u5B9E\u666F\u6570\u636E"})},"key_look_real")]}},{title:"\u6279\u6B21\u7ED3\u679CID",dataIndex:"loadNumber",width:170,renderText:u.zL},{title:"\u4EA7\u54C1\u7CFB\u7EDF\u540D\u79F0",width:128,dataIndex:"productName",ellipsis:!0},{title:"\u7CFB\u7EDF\u4EA7\u54C1ID",dataIndex:"productUuid",width:170,renderText:u.zL},{title:"\u63CF\u8FF0",dataIndex:"productDescription",width:200,ellipsis:!0},{title:"\u64CD\u4F5C\u4EBA",dataIndex:"operator",width:100,ellipsis:!0},{title:"\u751F\u6210\u65F6\u95F4",dataIndex:"calculateSuccessTime",valueType:"dateTime",width:180},{title:"\u78B3\u8DB3\u8FF9\u7ED3\u679C",dataIndex:"state",width:130,render:function(i,o){var S,$;return(0,e.jsx)("div",{className:ot()({"cursor-pointer":o.state===1},(S=vt[o.state])===null||S===void 0?void 0:S.color),onClick:function(){o.state===1&&C.history.push("/main/tools/inventory/result?id=".concat(o.loadNumber))},children:($=vt[o.state])===null||$===void 0?void 0:$.text})}},{title:"\u7EC4\u7EC7\u540D\u79F0",dataIndex:"orgName",width:130,ellipsis:!0},{title:"\u7EC4\u7EC7\u7F16\u53F7",dataIndex:"orgSerialNumber",width:130,ellipsis:!0}]},[]),y=(0,at.cc)(s,1e4),N=y.data,w=y.isLoading,L=y.mutate,U=(0,n.useMemo)(function(){return((N==null?void 0:N.records)||[]).map(function(l,i){return v()(v()({},l),{},{key:"key_inventory_"+i})})},[N]),V=(0,rt.b)(),K=(0,n.useMemo)(function(){return[{title:"\u53C2\u6570\u540D",dataIndex:"name",ellipsis:!0,width:200},{title:"\u8FC7\u7A0B\u540D\u79F0",dataIndex:"uuid",width:170},{title:"\u53C2\u8003\u503C",dataIndex:"optName",width:100},{title:"\u8F93\u5165\u503C",dataIndex:"inputData",width:100}]},[]),m=(0,n.useMemo)(function(){var l;if(!c.current)return[];var i=(0,Q.OA)(c.current.data)||[],o=c.current.inputData,S=c.current.inputData?_.mapKeys(typeof o=="string"?(0,Q.OA)(o)||[]:o,function(I){return I.paramName}):{},$=((l=i[0])===null||l===void 0?void 0:l.parameters)||[];return $.map(function(I){var j;return[I.name,I.context.name,I.value,((j=S[I.name])===null||j===void 0?void 0:j.paramValue)||""]}).map(function(I){var j=d()(I,4),ut=j[0],nt=j[1],it=j[2],dt=j[3];return{name:ut,uuid:nt,optName:it.toString(),inputData:dt}})},[c.current]);return(0,e.jsxs)(x.Z,{title:"\u6211\u7684\u4EA7\u54C1\u78B3\u8DB3\u8FF9\u7ED3\u679C",extra:V?[(0,e.jsx)(F.u,{onClick:function(){return A(!0)},children:"\u65B0\u5EFA\u78B3\u8DB3\u8FF9\u7ED3\u679C"},"new_inventory")]:[],children:[(0,e.jsx)("div",{className:"bg-white",children:(0,e.jsx)(u.ZP,{columns:f,dataSource:U,loading:w,pagination:{pageSize:10,total:(N==null?void 0:N.total)||0,current:s,onChange:function(i){R(i)}}})}),Y&&(0,e.jsx)(jt,{openResultModal:function(){return A(!1)},getList:function(){R(1),s===1&&L()}}),q&&(0,e.jsx)(J.d,{isShow:!0,header:K,data:m,onClose:function(){return Z(!1)}})]})}var Et=Lt,Mt=function(){var X=(0,C.useLocation)(),h=X.pathname;return console.info("inventoryPage:",h),h!=="/main/tools/inventory"?(0,e.jsx)(C.Outlet,{}):(0,e.jsx)(Et,{})}},85193:function(st,z,t){t.d(z,{S1:function(){return G},ZT:function(){return b},jU:function(){return d},on:function(){return v}});var b=function(){};function v(a){for(var x=[],u=1;u<arguments.length;u++)x[u-1]=arguments[u];a&&a.addEventListener&&a.addEventListener.apply(a,x)}function G(a){for(var x=[],u=1;u<arguments.length;u++)x[u-1]=arguments[u];a&&a.removeEventListener&&a.removeEventListener.apply(a,x)}var d=typeof window!="undefined",H=typeof navigator!="undefined"},76852:function(st,z,t){var b=t(79685),v=t(85193),G=["mousedown","touchstart"],d=function(H,a,x){x===void 0&&(x=G);var u=(0,b.useRef)(a);(0,b.useEffect)(function(){u.current=a},[a]),(0,b.useEffect)(function(){for(var F=function(C){var P=H.current;P&&!P.contains(C.target)&&u.current(C)},J=0,at=x;J<at.length;J++){var rt=at[J];(0,v.on)(document,rt,F)}return function(){for(var C=0,P=x;C<P.length;C++){var ot=P[C];(0,v.S1)(document,ot,F)}}},[x,H])};z.Z=d}}]);
