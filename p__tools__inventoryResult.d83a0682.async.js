"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7998],{64082:function(Q,N,e){var I=e(48651),l=e.n(I),A=e(38046),h=e.n(A),y=e(30541),u=e(33421),j=e(68591),x=e.n(j),D=e(63342),o=["className"];function n(O){var R=O.className,L=h()(O,o),d=(0,u.l)(function(E){var m=E.token;return{".ant-page-header":{padding:"1rem 1.5rem",backgroundColor:m.colorBgBase,".ant-breadcrumb":{fontSize:".875rem",marginBottom:"0.5rem"},".ant-page-header-heading-title":{fontSize:"1.25rem"}},".ant-pro-grid-content":{padding:"1.5rem",backgroundColor:"transparent",".ant-pro-page-container-children-content":{padding:0,paddingBlock:"0 !important"},".ant-pro-page-container-children-container":{paddingBlock:"0 !important",paddingInline:"0 !important"}}}});return(0,D.jsx)(y._z,l()({className:x()(R,d)},L))}N.Z=n},9991:function(Q,N,e){e.d(N,{u:function(){return L},z:function(){return R}});var I=e(5677),l=e.n(I),A=e(48651),h=e.n(A),y=e(38046),u=e.n(y),j=e(68591),x=e.n(j),D=e(68717),o=e(63342),n=["children","className"],O=["busy","disabled","className","defStyle","children"];function R(d){var E=d.children,m=d.className,M=u()(d,n);return(0,o.jsx)("button",h()(h()({},M),{},{className:x()(m),children:d.children}))}function L(d){var E,m=d.busy,M=d.disabled,X=d.className,k=d.defStyle,V=k===void 0?"btn-primary":k,$=d.children,i=u()(d,O);return(0,o.jsx)("button",h()(h()({className:x()(X,(E={},l()(E,V,!M),l()(E,"btn-disable",M),E))},i),{},{children:m?(0,o.jsx)(D.fCD,{className:"animate-spin"}):$}))}},2042:function(Q,N,e){e.d(N,{n:function(){return h},s:function(){return A}});var I=e(97207),l=e.n(I);function A(y){var u=l().groupBy(y,"flowId"),j=function x(D){D.forEach(function(o){if(o._child||(o._child=(o.childFlowIds||[]).map(function(O){return u[O][0]}),x(o._child)),o._child.length===0)o._depth=0;else{var n;o._depth=(((n=l().maxBy(o._child,"_depth"))===null||n===void 0?void 0:n._depth)||0)+1}})};j(y)}var h=function(u,j){var x=typeof u=="string"?[u]:u;return!!l().find(x,function(D){return D.startsWith(j)})}},83556:function(Q,N,e){e.r(N),e.d(N,{default:function(){return ye}});var I=e(22786),l=e.n(I),A=e(46299),h=e.n(A),y=e(86516),u=e.n(y),j=e(64082),x=e(48651),D=e.n(x),o=e(42586),n=e(63342);function O(b){return(0,n.jsx)(o.Z,D()({opts:{locale:"en"},notMerge:!0,lazyUpdate:!0},b))}var R=e(9991),L=e(11e3),d=e(85223),E=e(54916),m=e(2042),M=e(81123),X=e(12564),k=e(68591),V=e.n(k),$=e(97207),i=e.n($),F=e(79685),ge=e(31807);function q(b){var U=b.children,P=b.tit,ee=b.className;return(0,n.jsxs)("div",{className:V()("for2pdf-item flex w-full flex-col bg-white min-h-[6.25rem] border-t-[3px] border-solid border-green-2",ee),style:{boxShadow:"0px 2px 10px 0px rgba(26, 62, 31, 0.10)"},children:[(0,n.jsx)("div",{className:"w-full h-[4.1875rem] flex justify-center items-center text-xl font-semibold text-black",style:{background:"linear-gradient(180deg, rgba(41, 149, 58, 0.12) 0%, rgba(41, 149, 58, 0) 100%)"},children:P}),U]})}function W(b){var U=b.tit,P=b.value;return(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("div",{className:"flex gap-2.5 items-center text-green-2 text-base",children:[(0,n.jsx)("div",{className:"w-1 h-1 shrink-0 rounded-sm bg-green-2 overflow-hidden"}),(0,n.jsx)("span",{className:"whitespace-nowrap",children:U})]}),(0,n.jsx)("div",{className:"text-base text-gray-6 text-right",children:P})]})}function xe(){var b=(0,X.useSearchParams)(),U=u()(b,1),P=U[0],ee=(0,F.useState)(!1),de=u()(ee,2),ie=de[0],ce=de[1],je=(0,F.useState)(),me=u()(je,2),Z=me[0],De=me[1],Pe=(0,F.useState)(!0),_e=u()(Pe,2),Be=_e[0],Ce=_e[1],Ne=function(){var B=h()(l()().mark(function v(){var s,c,_;return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(P.get("id")){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,(0,E.fF)(P.get("id"));case 4:if(s=r.sent,s){r.next=7;break}return r.abrupt("return");case 7:return r.next=9,(0,E.Yp)(s.modelId);case 9:c=r.sent,_=c.modelBomInfo,De({lca:s,bominfo:_}),Ce(!1);case 13:case"end":return r.stop()}},v)}));return function(){return B.apply(this,arguments)}}();(0,F.useEffect)(function(){Ne()},[P.get("id")]);var ne=(0,F.useMemo)(function(){var B=[],v="",s=["",""],c={};if(Z){var _=Z.lca,g=Z.bominfo,r=(0,M.OA)(_.lcaResult);if(r){var S,f,re,te,ae,oe,ve=(((S=r.extra)===null||S===void 0?void 0:S.targetAmount)||"").split("Item(s)");B={productSystemName:(f=r.extra)===null||f===void 0?void 0:f.productSystemName,methodName:(re=r.extra)===null||re===void 0?void 0:re.methodName,targetName:ve[1]||((te=r.extra)===null||te===void 0?void 0:te.productSystemName),targetAmount:"".concat(Math.round(ve[0]||1)," (\u4EF6)"),calculateSuccessTime:_.calculateSuccessTime,loadNumber:_.loadNumber,loadName:_.loadName},v=r.totalImpacts&&((ae=r.totalImpacts[0])===null||ae===void 0?void 0:ae.impact.referenceUnit)||"";var Ie=i().round(r.totalResult||((oe=r.treeNode)===null||oe===void 0?void 0:oe.result)||0,2);s=["".concat(Ie||0),v]}var Y=(0,M.OA)(g),pe=(0,M.OA)(_.lcaTagResult);if(Y&&pe){var H=i().groupBy(pe,"flowId"),Ae=i().groupBy(Y,"flowId");(0,m.s)(Y);var Re=Y;c={padding:20,tooltip:{trigger:"item",formatter:function(a){var p="".concat(a.name," ").concat(a.value,"(").concat(v,")");return a.marker?"".concat(a.marker," ").concat(p):p}},series:{type:"sankey",data:[],links:[]}};var Se=function(a){return(0,m.n)(a.tagType,"STAGE01")?"\u4F7F\u7528\u73AF\u8282":(0,m.n)(a.tagType,"STAGE02")?"\u8FD0\u8F93\u9500\u552E\u73AF\u8282":(0,m.n)(a.tagType,"STAGE03")?"\u751F\u4EA7\u5236\u9020\u73AF\u8282":""},Te=function(a){if((0,m.n)(a.tagType,"REFERENCE"))return"\u4F7F\u7528\u73AF\u8282";if((0,m.n)(a.tagType,"STAGE")){if(a._depth===1)return"\u751F\u4EA7\u5236\u9020\u73AF\u8282";if(a._depth===2)return"\u8FD0\u8F93\u9500\u552E\u73AF\u8282"}return""},T={};Re.forEach(function(t){var a;(0,m.n)(t.tagType,"REFERENCE")&&(B.targetName=t.flowName);var p=c.series.links,C=c.series.data,Ee=((a=i().first(H[t.flowId]))===null||a===void 0?void 0:a.result)||0;T[t.flowName]||(T[t.flowName]=!0,C==null||C.push({name:t.flowName,value:i().round(Ee,2),depth:t._depth})),t.childFlowIds&&t.childFlowIds.length&&t.childFlowIds.forEach(function(J){var z=i().first(H[J]),le=i().first(Ae[J]);if(le&&z){var ue=i().first(H[le.flowId]),Le=i().round((ue==null?void 0:ue.result)||0,2);p==null||p.push({target:t.flowName,source:le.flowName,value:Le})}});var se=i().round(Ee-i().sumBy(t.childFlowIds||[],function(J){var z;return(z=H[J][0])===null||z===void 0?void 0:z.result}),2),w=Se(t);if(w&&t._depth>0)T[w]||(T[w]=!0,C==null||C.push({name:w,depth:t._depth-1})),p==null||p.push({target:t.flowName,source:w,value:se});else if(se>0&&t._depth>0){var G=Te(t);G&&(T[G]||(T[G]=!0,C==null||C.push({name:G,depth:t._depth-1})),p==null||p.push({target:t.flowName,source:G,value:se}))}})}}return{generalInfo:B,carbonResult:s,chartData:c}},[Z]),K=ne.generalInfo,fe=ne.carbonResult,he=ne.chartData,Oe=function(){var B=h()(l()().mark(function v(){var s,c,_,g,r;return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(!P.get("id")||ie)){f.next=2;break}return f.abrupt("return",!1);case 2:return ce(!0),f.next=5,(0,E.LW)(P.get("id"));case 5:s=f.sent,s.headers&&(c=s.headers.get("content-disposition"),c&&(_=c.match(/filename=(.+)/),_&&(ce(!1),g=new Blob([s.data]),r=document.createElement("a"),r.download=_[1],r.style.display="none",r.href=URL.createObjectURL(g),document.body.appendChild(r),r.click(),URL.revokeObjectURL(r.href),document.body.removeChild(r))));case 7:case"end":return f.stop()}},v)}));return function(){return B.apply(this,arguments)}}(),Me=function(){var B=h()(l()().mark(function v(){var s,c;return l()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(s=document.getElementById("inventory-result-content"),s){g.next=3;break}return g.abrupt("return");case 3:c="PCF-".concat(K.loadName,".pdf"),ge().set({margin:5,filename:c,html2canvas:{width:1200,windowWidth:1200,onclone:function(S){i().forEach(S.getElementsByClassName("for2pdf-item"),function(f){f.style.boxShadow="none"})}}}).from(s).save();case 5:case"end":return g.stop()}},v)}));return function(){return B.apply(this,arguments)}}();return(0,n.jsx)(j.Z,{title:"\u78B3\u8DB3\u8FF9\u7ED3\u679C",className:"text-lg text-black",extra:[(0,n.jsx)(R.u,{onClick:Me,children:"\u5C06\u6B64\u9875\u9762\u751F\u6210PDF"},"key_export_pdf"),(0,n.jsx)(R.u,{onClick:Oe,busy:ie,children:"\u5BFC\u51FA\u8BA1\u7B97\u660E\u7EC6Excel"},"key_export_excel")],children:Be?(0,n.jsx)("div",{className:"h-[100vh] w-full items-center",children:(0,n.jsx)(L.g,{})}):(0,n.jsx)("div",{className:"mo:break-all max-w-[1200px] inventory-result-content",id:"inventory-result-content",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-5 mo:grid-cols-1",children:[(0,n.jsx)(q,{tit:"\u4EA7\u54C1\u78B3\u8DB3\u8FF9",children:(0,n.jsxs)("div",{className:"flex items-center flex-1 px-9 mb-9",children:[(0,n.jsx)(d.vD,{}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col justify-center items-center whitespace-nowrap",children:[(0,n.jsx)("span",{className:"font-semibold text-green-2 text-4xl",children:fe[0]}),(0,n.jsx)("span",{className:"font-semibold text-black text-base",children:fe[1]})]})]})}),(0,n.jsx)(q,{tit:"\u78B3\u8DB3\u8FF9\u8BC4\u4EF7\u8BE6\u60C5",children:(0,n.jsxs)("div",{className:"flex flex-col gap-3 mx-5 mt-3 mb-9",children:[(0,n.jsx)(W,{tit:"\u76EE\u6807\u4EA7\u54C1",value:K.targetName}),(0,n.jsx)(W,{tit:"\u76EE\u6807\u4EA7\u54C1\u6570\u91CF",value:K.targetAmount}),(0,n.jsx)(W,{tit:"\u78B3\u8DB3\u8FF9\u6279\u6B21",value:K.loadName}),(0,n.jsx)(W,{tit:"\u73AF\u5883\u5F71\u54CD\u8BC4\u4EF7\u65B9\u6CD5",value:"IPCC 2021,GWP 100"}),(0,n.jsx)(W,{tit:"\u8BA1\u7B97\u7ED3\u679C\u751F\u6210\u65F6\u95F4",value:K.calculateSuccessTime})]})}),(0,n.jsx)(q,{tit:"\u751F\u547D\u5468\u671F\u73AF\u8282\u660E\u7EC6\u7ED3\u679C",className:"col-span-2 mo:col-span-1",children:he&&(0,n.jsx)(O,{className:"w-full !h-[360px]",option:he})})]})})})}var be=xe,ye=be}}]);
