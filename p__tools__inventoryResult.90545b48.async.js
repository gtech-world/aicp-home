"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7998],{9991:function(ue,D,r){r.d(D,{u:function(){return Q},z:function(){return W}});var S=r(5677),f=r.n(S),A=r(48651),p=r.n(A),y=r(38046),l=r.n(y),b=r(68591),E=r.n(b),N=r(68717),e=r(63342),C=["children","className"],O=["busy","disabled","className","defStyle","children"];function W(s){var o=s.children,B=s.className,P=l()(s,C);return(0,e.jsx)("button",p()(p()({},P),{},{className:E()(B),children:s.children}))}function Q(s){var o,B=s.busy,P=s.disabled,X=s.className,K=s.defStyle,V=K===void 0?"btn-primary":K,k=s.children,u=l()(s,O);return(0,e.jsx)("button",p()(p()({className:E()(X,(o={},f()(o,V,!P),f()(o,"btn-disable",P),o))},u),{},{children:B?(0,e.jsx)(N.fCD,{className:"animate-spin"}):k}))}},2042:function(ue,D,r){r.d(D,{n:function(){return p},s:function(){return A}});var S=r(97207),f=r.n(S);function A(y){var l=f().groupBy(y,"flowId"),b=function E(N){N.forEach(function(e){if(e._child||(e._child=(e.childFlowIds||[]).map(function(O){return l[O][0]}),E(e._child)),e._child.length===0)e._depth=0;else{var C;e._depth=(((C=f().maxBy(e._child,"_depth"))===null||C===void 0?void 0:C._depth)||0)+1}})};b(y)}var p=function(l,b){var E=typeof l=="string"?[l]:l;return!!f().find(E,function(N){return N.startsWith(b)})}},83556:function(ue,D,r){r.r(D),r.d(D,{default:function(){return je}});var S=r(22786),f=r.n(S),A=r(46299),p=r.n(A),y=r(86516),l=r.n(y),b=r(48651),E=r.n(b),N=r(42586),e=r(63342);function C(v){return(0,e.jsx)(N.Z,E()({opts:{locale:"en"},notMerge:!0,lazyUpdate:!0},v))}var O=r(9991),W=r(11e3),Q=r(85223),s=r(54916),o=r(2042),B=r(81123),P=r(30541),X=r(49759),K=r(68591),V=r.n(K),k=r(97207),u=r.n(k),M=r(79685);function $(v){var T=v.children,_=v.tit,q=v.className;return(0,e.jsxs)("div",{className:V()("flex w-full flex-col bg-white min-h-[6.25rem]",q),style:{boxShadow:"0px 3px 0px 0px #29953A inset, 0px 2px 10px 0px rgba(26, 62, 31, 0.10)"},children:[(0,e.jsx)("div",{className:"w-full h-[4.1875rem] flex justify-center items-center text-xl font-semibold text-black",style:{background:"linear-gradient(180deg, rgba(41, 149, 58, 0.12) 0%, rgba(41, 149, 58, 0) 100%)"},children:_}),T]})}function R(v){var T=v.tit,_=v.value;return(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsxs)("div",{className:"flex gap-2.5 items-center text-green-2 text-base",children:[(0,e.jsx)("div",{className:"w-1 h-1 shrink-0 rounded-sm bg-green-2 overflow-hidden"}),(0,e.jsx)("span",{className:"whitespace-nowrap",children:T})]}),(0,e.jsx)("div",{className:"text-base text-gray-6 text-right",children:_})]})}function xe(){var v=(0,X.useSearchParams)(),T=l()(v,1),_=T[0],q=(0,M.useState)(!1),de=l()(q,2),ie=de[0],ce=de[1],ye=(0,M.useState)(),fe=l()(ye,2),G=fe[0],be=fe[1],Ne=(0,M.useState)(!0),me=l()(Ne,2),Ce=me[0],Be=me[1],De=function(){var j=p()(f()().mark(function g(){var d,m,i;return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(_.get("id")){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,(0,s.fF)(_.get("id"));case 4:if(d=t.sent,d){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,(0,s.Yp)(d.modelId);case 9:m=t.sent,i=m.modelBomInfo,be({lca:d,bominfo:i}),Be(!1);case 13:case"end":return t.stop()}},g)}));return function(){return j.apply(this,arguments)}}();(0,M.useEffect)(function(){De()},[_.get("id")]);var ee=(0,M.useMemo)(function(){var j=[],g="",d=["",""],m={};if(G){var i=G.lca,F=G.bominfo,t=(0,B.OA)(i.lcaResult);if(t){var Y,h,re,te,ne,ae,pe=(((Y=t.extra)===null||Y===void 0?void 0:Y.targetAmount)||"").split("Item(s)");j={productSystemName:(h=t.extra)===null||h===void 0?void 0:h.productSystemName,methodName:(re=t.extra)===null||re===void 0?void 0:re.methodName,targetName:pe[1]||((te=t.extra)===null||te===void 0?void 0:te.productSystemName),targetAmount:"".concat(Math.round(pe[0]||1)," (\u4EF6)"),calculateSuccessTime:i.calculateSuccessTime,loadNumber:i.loadNumber,loadName:i.loadName},g=t.totalImpacts&&((ne=t.totalImpacts[0])===null||ne===void 0?void 0:ne.impact.referenceUnit)||"";var Ie=u().round(t.totalResult||((ae=t.treeNode)===null||ae===void 0?void 0:ae.result)||0,2);d=["".concat(Ie||0),g]}var Z=(0,B.OA)(F),_e=(0,B.OA)(i.lcaTagResult);if(Z&&_e){var H=u().groupBy(_e,"flowId"),Se=u().groupBy(Z,"flowId");(0,o.s)(Z);var Ae=Z;m={padding:20,tooltip:{trigger:"item",formatter:function(a){console.info("item:",a);var c="".concat(a.name," ").concat(a.value,"(").concat(g,")");return a.marker?"".concat(a.marker," ").concat(c):c}},series:{type:"sankey",data:[],links:[]}};var Oe=function(a){return(0,o.n)(a.tagType,"STAGE01")?"\u4F7F\u7528\u73AF\u8282":(0,o.n)(a.tagType,"STAGE02")?"\u8FD0\u8F93\u9500\u552E\u73AF\u8282":(0,o.n)(a.tagType,"STAGE03")?"\u751F\u4EA7\u5236\u9020\u73AF\u8282":""},Me=function(a){if((0,o.n)(a.tagType,"REFERENCE"))return"\u4F7F\u7528\u73AF\u8282";if((0,o.n)(a.tagType,"STAGE")){if(a._depth===1)return"\u751F\u4EA7\u5236\u9020\u73AF\u8282";if(a._depth===2)return"\u8FD0\u8F93\u9500\u552E\u73AF\u8282"}return""},I={};Ae.forEach(function(n){var a;(0,o.n)(n.tagType,"REFERENCE")&&(j.targetName=n.flowName);var c=m.series.links,x=m.series.data,ge=((a=u().first(H[n.flowId]))===null||a===void 0?void 0:a.result)||0;I[n.flowName]||(I[n.flowName]=!0,x==null||x.push({name:n.flowName,value:u().round(ge,2),depth:n._depth})),n.childFlowIds&&n.childFlowIds.length&&n.childFlowIds.forEach(function(J){var w=u().first(H[J]),le=u().first(Se[J]);if(le&&w){var oe=u().first(H[le.flowId]),Re=u().round((oe==null?void 0:oe.result)||0,2);c==null||c.push({target:n.flowName,source:le.flowName,value:Re})}});var se=u().round(ge-u().sumBy(n.childFlowIds||[],function(J){var w;return(w=H[J][0])===null||w===void 0?void 0:w.result}),2),L=Oe(n);if(L&&n._depth>0)I[L]||(I[L]=!0,x==null||x.push({name:L,depth:n._depth-1})),c==null||c.push({target:n.flowName,source:L,value:se});else if(se>0&&n._depth>0){var U=Me(n);U&&(I[U]||(I[U]=!0,x==null||x.push({name:U,depth:n._depth-1})),c==null||c.push({target:n.flowName,source:U,value:se}))}})}}return{generalInfo:j,carbonResult:d,chartData:m}},[G]),z=ee.generalInfo,he=ee.carbonResult,ve=ee.chartData,Pe=function(){var j=p()(f()().mark(function g(){var d,m,i,F,t;return f()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(_.get("id")){h.next=2;break}return h.abrupt("return",!1);case 2:return ce(!0),h.next=5,(0,s.LW)(_.get("id"));case 5:d=h.sent,d.headers&&(m=d.headers.get("content-disposition"),m&&(i=m.match(/filename=(.+)/),i&&(ce(!1),F=new Blob([d.data]),t=document.createElement("a"),t.download=i[1],t.style.display="none",t.href=URL.createObjectURL(F),document.body.appendChild(t),t.click(),URL.revokeObjectURL(t.href),document.body.removeChild(t))));case 7:case"end":return h.stop()}},g)}));return function(){return j.apply(this,arguments)}}();return(0,e.jsx)(P._z,{title:"\u78B3\u8DB3\u8FF9\u7ED3\u679C",className:"text-lg text-black",children:Ce?(0,e.jsx)("div",{className:"h-[100vh] w-full items-center",children:(0,e.jsx)(W.g,{})}):(0,e.jsxs)("div",{className:"pt-8 mo:break-all",children:[(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-5 mo:grid-cols-1",children:[(0,e.jsx)($,{tit:"\u4EA7\u54C1\u78B3\u8DB3\u8FF9",children:(0,e.jsxs)("div",{className:"flex items-center flex-1 px-9 mb-9",children:[(0,e.jsx)(Q.vD,{}),(0,e.jsxs)("div",{className:"flex-1 flex flex-col justify-center items-center whitespace-nowrap",children:[(0,e.jsx)("span",{className:"font-semibold text-green-2 text-4xl",children:he[0]}),(0,e.jsx)("span",{className:"font-semibold text-black text-base",children:he[1]})]})]})}),(0,e.jsx)($,{tit:"\u78B3\u8DB3\u8FF9\u8BC4\u4EF7\u8BE6\u60C5",children:(0,e.jsxs)("div",{className:"flex flex-col gap-3 mx-5 mt-3 mb-9",children:[(0,e.jsx)(R,{tit:"\u76EE\u6807\u4EA7\u54C1",value:z.targetName}),(0,e.jsx)(R,{tit:"\u76EE\u6807\u4EA7\u54C1\u6570\u91CF",value:z.targetAmount}),(0,e.jsx)(R,{tit:"\u78B3\u8DB3\u8FF9\u6279\u6B21",value:z.loadName}),(0,e.jsx)(R,{tit:"\u73AF\u5883\u5F71\u54CD\u8BC4\u4EF7\u65B9\u6CD5",value:"IPCC 2021,GWP 100"}),(0,e.jsx)(R,{tit:"\u8BA1\u7B97\u7ED3\u679C\u751F\u6210\u65F6\u95F4",value:z.calculateSuccessTime})]})}),(0,e.jsx)($,{tit:"\u751F\u547D\u5468\u671F\u73AF\u8282\u660E\u7EC6\u7ED3\u679C",className:"col-span-2 mo:col-span-1",children:ve&&(0,e.jsx)(C,{className:"w-full !h-[360px]",option:ve})})]}),(0,e.jsx)("div",{className:"flex justify-center w-full mt-5 mb-10",children:(0,e.jsx)(O.z,{onClick:function(){return!ie&&Pe()},className:"mt-5 text-lg bg-green-2 w-[26.875rem] text-white rounded-lg  h-14 flex items-center justify-center hover:bg-green-28",children:ie?(0,e.jsx)("div",{children:(0,e.jsx)(W.g,{size:"2rem",color:"#fff"})}):(0,e.jsx)("span",{children:"\u5BFC\u51FAExcel"})})})]})})}var Ee=xe,je=Ee}}]);
