"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[9725],{75631:function(et,O,t){t.r(O),t.d(O,{default:function(){return Nt}});var P=t(48651),l=t.n(P),$=t(86516),i=t.n($),U=t(5677),n=t.n(U),m=t(64082),u=t(18842),j=t(9991),G=t(5053),k=t(8965),q=t(76222),S=t(12564),B=t(68591),_=t.n(B),r=t(79685),ut=t(22786),at=t.n(ut),dt=t(46299),it=t.n(dt),nt=t(95968),tt=t(54916),rt=t(81123),st=t(48294),e=t(63342),ct=function(v){var d=v.onOpenModal,E=v.realData,x=v.tableData,h=v.realArr,J=(0,r.useState)(x),T=i()(J,2),K=T[0],A=T[1],W=function(){for(var o,s=(o=document)===null||o===void 0?void 0:o.getElementById("realDataTable"),M=s.getElementsByTagName("tr"),g=[],R=0;R<M.length;R++){for(var I=[],Z=M[R].getElementsByTagName("input"),b=0;b<Z.length;b++){var c=Z[b].value;I.push(c)}g.push(I)}var a=[];a=x==null?void 0:x.map(function(D,w){var Q={processId:D.context["@id"],paramValue:g.slice(1)[w][0]||D.value.toString(),paramName:D.name,dateTime:(0,rt.p6)()};return Q});var p={lcaParamList:a};typeof d=="function"&&d(),typeof E=="function"&&E(p)};(0,r.useEffect)(function(){var N=x==null?void 0:x.map(function(o,s){return h!=null&&h.length&&h[s].paramName===o.name?l()(l()({},o),{},{inputValue:h[s].paramValue}):l()({},o)});A(N)},[h,x]);var z=[{title:"\u53C2\u6570\u540D",dataIndex:"name",width:"9rem",render:function(o){return(0,e.jsx)("div",{className:" flex items-center h-[33px] font-normal leading-[21px] text-[14px] ",children:o})}},{title:"\u8FC7\u7A0B\u540D\u79F0",dataIndex:"name",width:"7rem",render:function(o,s){return(0,e.jsx)("div",{className:"flex items-center  h-[33px] font-normal leading-[21px] text-[14px] ",children:s.context.name})}},{title:"\u53C2\u8003\u503C",width:"10rem",dataIndex:"value",render:function(o){return(0,e.jsx)("div",{className:"flex items-center h-[33px] font-normal leading-[21px] text-[14px] ",children:o})}},{title:"\u586B\u5165\u503C",width:"10rem",dataIndex:"createTime",render:function(o,s){return(0,e.jsx)("input",{defaultValue:s.inputValue,type:"number",className:"font-normal  leading-[21px] text-[14px] w-[10rem] h-[33px] "})}}];return(0,e.jsxs)(nt.u_,{title:"\u5B9E\u666F\u6570\u636E\u586B\u62A5",containerClassName:"mx-5 max-w-[640px]",titleClassName:"text-[20px] leading-5 font-bold",onClose:typeof d=="function"&&d||void 0,children:[(0,e.jsx)("div",{className:" mx-5 w-[640px] max-h-[400px] overflow-y-auto ",children:(0,e.jsx)(st.i,{columns:z,tableId:"realDataTable",data:K||[],isSetBorder:!0,maxHeight:"calc(100vh - 260px)",headerClassName:{background:"#DDDDDD",position:"sticky",top:"-1px",fontWeight:"700",fontSize:"18px",lineHeight:"30px",height:"50px"}})}),(0,e.jsx)("div",{className:"mx-5 ",children:(0,e.jsxs)("div",{className:"flex flex-row justify-between gap-5 mt-5",children:[(0,e.jsx)(j.u,{onClick:typeof d=="function"&&d||void 0,defStyle:"btn-primary-1",className:"flex-1  font-normal  h-[50px] border-2 text-[18px]",children:"\u53D6\u6D88"}),(0,e.jsx)(j.u,{className:"flex-1 h-[50px]  font-normal  text-[18px]",onClick:W,children:"\u786E\u5B9A"})]})})]})},ft=ct,mt=t(46284),vt=t(3826),pt=t(7698),xt={loadName:"",productId:""},ht=function(v){var d=v.openResultModal,E=v.getList,x=(0,r.useState)(!1),h=i()(x,2),J=h[0],T=h[1],K=(0,r.useState)([{name:"",id:""}]),A=i()(K,2),W=A[0],z=A[1],N=(0,r.useState)({lcaParamList:[]}),o=i()(N,2),s=o[0],M=o[1],g=(0,r.useState)([]),R=i()(g,2),I=R[0],Z=R[1],b=(0,r.useState)(xt),c=i()(b,2),a=c[0],p=c[1],D=(0,r.useMemo)(function(){return W.map(function(y){return{value:y.id,label:y.name}})},[W]),w=(0,r.useState)(!0),Q=i()(w,2),St=Q[0],It=Q[1],Ct=function(){(0,tt.ev)().then(function(f){z(f||{name:"",id:""}),It(!1)}).catch(function(f){}).finally()},Lt=function(){var f,C=a.loadName,F=a.productId;if(!(!C||!F)){var X=I==null?void 0:I.map(function(Y){return{processId:Y.context["@id"],paramValue:Y.value.toString(),paramName:Y.name,dateTime:(0,rt.p6)()}}),L=(f=s.lcaParamList)!==null&&f!==void 0&&f.length?s:{lcaParamList:X.length?X:void 0},Rt=l()(l()({},L),{},{loadName:C,productId:F});(0,tt.E)(Rt).then(function(Y){typeof E=="function"&&E()}).catch(function(Y){}).finally(function(){typeof d=="function"&&d()})}};(0,r.useEffect)(function(){Ct()},[]);var jt=function(){a.productId&&T(!0)},lt=function(f,C){p(function(F){return l()(l()({},F),{},n()({},C,f))})},Et=function(){var y=it()(at()().mark(function f(){return at()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:(0,tt.NF)(a.productId).then(function(X){var L=JSON.parse(X.paramDetail)[0]||[];Z(JSON.stringify(L)==="{}"||!(L!=null&&L.parameters)?[]:L==null?void 0:L.parameters)}).catch(function(X){}).finally();case 1:case"end":return F.stop()}},f)}));return function(){return y.apply(this,arguments)}}();(0,r.useEffect)(function(){a.productId&&Et()},[a.productId]);var Tt={loadName:"",productId:"",realDataInput:""},Mt=[{label:"\u78B3\u8DB3\u8FF9\u6279\u6B21",dataIndex:"loadName",render:function(){return(0,e.jsx)(vt.Z,{value:a.loadName,onChange:function(C){return lt(C.target.value,"loadName")},id:"loadName",name:"loadName",maxLength:30,className:"w-full mb-[20px] mt-[10px] px-5 border border-[#DDDDDD]  h-[50px]  bg-[#F8F8F8] rounded-lg"})}},{label:"\u4EA7\u54C1\u7CFB\u7EDF",dataIndex:"productId",render:function(){return(0,e.jsx)(pt.default,{value:a.productId,style:{height:"50px",borderColor:"#DDDDDD",backgroundColor:"#F8F8F8",width:"100%"},onChange:function(C){return lt(C,"productId")},options:D})}},{label:"\u5B9E\u666F\u6570\u636E\u586B\u62A5",dataIndex:"realDataInput",render:function(){return(0,e.jsx)("div",{onClick:function(){return jt()},className:" flex cursor-pointer rounded-[4px] leading-4 text-[16px] mt-[10px] bg-[#F1F1F1] w-[84px] h-[24px]  text-center items-center justify-center ",children:"\u524D\u5F80\u586B\u5199"})}}];return St?null:(0,e.jsxs)(r.Fragment,{children:[(0,e.jsxs)(nt.u_,{className:"rounded-lg",containerClassName:"mx-5 w-[640px]",titleClassName:"text-[20px] leading-5 font-bold",title:"\u65B0\u5EFA\u78B3\u8DB3\u8FF9\u7ED3\u679C",onClose:d,children:[(0,e.jsx)("div",{className:"mx-5 w-[640px] ",children:(0,e.jsx)(mt.Z,{options:Mt,data:Tt,optionEmptyText:"-",layout:"vertical",column:1,contentStyle:{color:"#999999",fontWeight:"400"},labelStyle:{color:"#000000",fontWeight:"400"}})}),(0,e.jsxs)("div",{className:"flex flex-row justify-between gap-5 px-5 mt-5",children:[(0,e.jsx)(j.u,{size:"large",onClick:d,defStyle:"btn-primary-1",className:"flex-1  font-normal  h-[50px] border-2 text-[18px]",children:"\u53D6\u6D88"}),(0,e.jsx)(j.u,{size:"large",className:"flex-1 h-[50px]  font-normal  text-[18px]",onClick:Lt,disabled:!a.productId||!a.loadName,children:"\u8BA1\u7B97\u78B3\u7ED3\u679C"})]})]}),J&&(0,e.jsx)(ft,{realData:M,tableData:I,realArr:s.lcaParamList,onOpenModal:function(){return T(!1)}})]})},gt=ht,V,ot=(V={},n()(V,-1,{color:"text-[red]",text:"\u8BA1\u7B97\u5931\u8D25"}),n()(V,0,{color:"text-[#FF9800]",text:"\u7B49\u5F85\u8BA1\u7B97"}),n()(V,1,{color:"text-green-2",text:"\u67E5\u770B\u7ED3\u679C"}),n()(V,2,{color:"text-blue-600",text:"\u6B63\u5728\u8BA1\u7B97"}),V);function Dt(){var H=(0,r.useState)(1),v=i()(H,2),d=v[0],E=v[1],x=(0,r.useState)(!1),h=i()(x,2),J=h[0],T=h[1],K=(0,r.useState)(!1),A=i()(K,2),W=A[0],z=A[1],N=(0,r.useRef)({inputData:"",data:""}),o=function(a){var p=a.param,D=a.paramDetail;N.current={inputData:p,data:D},z(!0)},s=(0,r.useMemo)(function(){return[{title:"\u78B3\u8DB3\u8FF9\u6279\u6B21",dataIndex:"loadName",width:180,ellipsis:!0},{title:"\u5B9E\u666F\u6570\u636E",valueType:"option",width:120,render:function(a,p){return[(0,e.jsx)("div",{className:"flex justify-center whitespace-nowrap px-2.5 bg-[#F1F1F1] rounded",onClick:function(){return o(p)},children:(0,e.jsx)("span",{className:"cursor-pointer",children:"\u67E5\u770B\u5B9E\u666F\u6570\u636E"})},"key_look_real")]}},{title:"\u6279\u6B21\u7ED3\u679CID",dataIndex:"loadNumber",width:170,renderText:u.zL},{title:"\u4EA7\u54C1\u7CFB\u7EDF\u540D\u79F0",width:128,dataIndex:"productName",ellipsis:!0},{title:"\u7CFB\u7EDF\u4EA7\u54C1ID",dataIndex:"productUuid",width:170,renderText:u.zL},{title:"\u63CF\u8FF0",dataIndex:"productDescription",width:300,ellipsis:!0},{title:"\u64CD\u4F5C\u4EBA",dataIndex:"operator",width:100,ellipsis:!0},{title:"\u751F\u6210\u65F6\u95F4",dataIndex:"calculateSuccessTime",valueType:"dateTime",width:180},{title:"\u78B3\u8DB3\u8FF9\u7ED3\u679C",dataIndex:"state",width:130,render:function(a,p){var D,w;return(0,e.jsx)("div",{className:_()({"cursor-pointer":p.state===1},(D=ot[p.state])===null||D===void 0?void 0:D.color),onClick:function(){p.state===1&&S.history.push("/main/tools/inventory/result?id=".concat(p.loadNumber))},children:(w=ot[p.state])===null||w===void 0?void 0:w.text})}},{title:"\u7EC4\u7EC7\u540D\u79F0",dataIndex:"orgName",width:130,ellipsis:!0},{title:"\u7EC4\u7EC7\u7F16\u53F7",dataIndex:"orgSerialNumber",width:130,ellipsis:!0}]},[]),M=(0,k.cc)(d,1e4),g=M.data,R=M.isLoading,I=M.mutate,Z=(0,r.useMemo)(function(){return((g==null?void 0:g.records)||[]).map(function(c,a){return l()(l()({},c),{},{key:"key_inventory_"+a})})},[g]),b=(0,q.b)();return(0,e.jsxs)(m.Z,{title:"\u6211\u7684\u4EA7\u54C1\u78B3\u8DB3\u8FF9\u7ED3\u679C",extra:b?[(0,e.jsx)(j.u,{onClick:function(){return T(!0)},children:"\u65B0\u5EFA\u78B3\u8DB3\u8FF9\u7ED3\u679C"},"new_inventory")]:[],children:[(0,e.jsx)("div",{className:"bg-white",children:(0,e.jsx)(u.ZP,{columns:s,dataSource:Z,loading:R,pagination:{pageSize:10,total:(g==null?void 0:g.total)||0,current:d,onChange:function(a){E(a)}}})}),J&&(0,e.jsx)(gt,{openResultModal:function(){return T(!1)},getList:function(){E(1),d===1&&I()}}),W&&(0,e.jsx)(G.d,l()(l()({},N.current),{},{onClose:function(){return z(!1)}}))]})}var yt=Dt,Nt=function(){var H=(0,S.useLocation)(),v=H.pathname;return console.info("inventoryPage:",v),v!=="/main/tools/inventory"?(0,e.jsx)(S.Outlet,{}):(0,e.jsx)(yt,{})}},85193:function(et,O,t){t.d(O,{S1:function(){return $},ZT:function(){return P},jU:function(){return i},on:function(){return l}});var P=function(){};function l(n){for(var m=[],u=1;u<arguments.length;u++)m[u-1]=arguments[u];n&&n.addEventListener&&n.addEventListener.apply(n,m)}function $(n){for(var m=[],u=1;u<arguments.length;u++)m[u-1]=arguments[u];n&&n.removeEventListener&&n.removeEventListener.apply(n,m)}var i=typeof window!="undefined",U=typeof navigator!="undefined"},76852:function(et,O,t){var P=t(79685),l=t(85193),$=["mousedown","touchstart"],i=function(U,n,m){m===void 0&&(m=$);var u=(0,P.useRef)(n);(0,P.useEffect)(function(){u.current=n},[n]),(0,P.useEffect)(function(){for(var j=function(S){var B=U.current;B&&!B.contains(S.target)&&u.current(S)},G=0,k=m;G<k.length;G++){var q=k[G];(0,l.on)(document,q,j)}return function(){for(var S=0,B=m;S<B.length;S++){var _=B[S];(0,l.S1)(document,_,j)}}},[m,U])};O.Z=i}}]);
