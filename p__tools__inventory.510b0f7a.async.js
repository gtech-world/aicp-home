"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[9725],{75631:function(st,$,t){t.r($),t.d($,{default:function(){return Mt}});var A=t(48651),f=t.n(A),G=t(86516),d=t.n(G),H=t(5677),a=t.n(H),x=t(64082),u=t(18842),T=t(9991),J=t(5053),at=t(8965),rt=t(76222),I=t(12564),P=t(68591),ot=t.n(P),n=t(79685),vt=t(22786),ct=t.n(vt),pt=t(46299),xt=t.n(pt),mt=t(95968),lt=t(54916),Q=t(81123),ht=t(48294),e=t(63342),gt=function(h){var s=h.onOpenModal,R=h.realData,g=h.tableData,D=h.realArr,Y=(0,n.useState)(g),F=d()(Y,2),k=F[0],O=F[1],q=function(){for(var r,v=(r=document)===null||r===void 0?void 0:r.getElementById("realDataTable"),w=v.getElementsByTagName("tr"),y=[],B=0;B<w.length;B++){for(var j=[],U=w[B].getElementsByTagName("input"),V=0;V<U.length;V++){var K=U[V].value;j.push(K)}y.push(j)}var m=[];m=g==null?void 0:g.map(function(i,o){var N={processId:i.context["@id"],paramValue:y.slice(1)[o][0]||i.value.toString(),paramName:i.name,dateTime:(0,Q.p6)()};return N});var l={lcaParamList:m};typeof s=="function"&&s(),typeof R=="function"&&R(l)};(0,n.useEffect)(function(){var c=g==null?void 0:g.map(function(r,v){return D!=null&&D.length&&D[v].paramName===r.name?f()(f()({},r),{},{inputValue:D[v].paramValue}):f()({},r)});O(c)},[D,g]);var Z=[{title:"\u53C2\u6570\u540D",dataIndex:"name",width:"9rem",render:function(r){return(0,e.jsx)("div",{className:" flex items-center h-[33px] font-normal leading-[21px] text-[14px] ",children:r})}},{title:"\u8FC7\u7A0B\u540D\u79F0",dataIndex:"name",width:"7rem",render:function(r,v){return(0,e.jsx)("div",{className:"flex items-center  h-[33px] font-normal leading-[21px] text-[14px] ",children:v.context.name})}},{title:"\u53C2\u8003\u503C",width:"10rem",dataIndex:"value",render:function(r){return(0,e.jsx)("div",{className:"flex items-center h-[33px] font-normal leading-[21px] text-[14px] ",children:r})}},{title:"\u586B\u5165\u503C",width:"10rem",dataIndex:"createTime",render:function(r,v){return(0,e.jsx)("input",{defaultValue:v.inputValue,type:"number",className:"font-normal  leading-[21px] text-[14px] w-[10rem] h-[33px] "})}}];return(0,e.jsx)(mt.u_,{title:"\u5B9E\u666F\u6570\u636E\u586B\u62A5",containerClassName:"mx-5 max-w-[640px]",titleClassName:"text-[20px] leading-5 font-bold",onClose:typeof s=="function"&&s||void 0,line:!0,bottomBtn:(0,e.jsx)("div",{className:"mx-5 ",children:(0,e.jsxs)("div",{className:"flex flex-row justify-between gap-5 ",children:[(0,e.jsx)(T.u,{size:"large",onClick:typeof s=="function"&&s||void 0,defStyle:"btn-primary-1",className:"flex-1  font-normal  h-[50px] border-2 text-[18px]",children:"\u53D6\u6D88"}),(0,e.jsx)(T.u,{size:"large",className:"flex-1 h-[50px]  font-normal  text-[18px]",onClick:q,children:"\u786E\u5B9A"})]})}),children:(0,e.jsx)("div",{className:" mx-5 w-[640px] max-h-[400px] overflow-y-auto ",children:(0,e.jsx)(ht.i,{columns:Z,tableId:"realDataTable",data:k||[],isSetBorder:!0,maxHeight:"calc(100vh - 260px)",headerClassName:{background:"#DDDDDD",position:"sticky",top:"-1px",fontWeight:"700",fontSize:"18px",lineHeight:"30px",height:"50px"}})})})},Dt=gt,yt=t(46284),Nt=t(3826),St=t(7698),It={loadName:"",productId:""},Ct=function(h){var s=h.openResultModal,R=h.getList,g=(0,n.useState)(!1),D=d()(g,2),Y=D[0],F=D[1],k=(0,n.useState)([{name:"",id:""}]),O=d()(k,2),q=O[0],Z=O[1],c=(0,n.useState)({lcaParamList:[]}),r=d()(c,2),v=r[0],w=r[1],y=(0,n.useState)([]),B=d()(y,2),j=B[0],U=B[1],V=(0,n.useState)(It),K=d()(V,2),m=K[0],l=K[1],i=(0,n.useState)(!0),o=d()(i,2),N=o[0],z=o[1],S=function(){(0,lt.ev)().then(function(p){Z(p||{name:"",id:""}),z(!1)}).catch(function(p){}).finally()},C=function(){var p,E=m.loadName,b=m.productId;if(!(!E||!b)){var tt=j==null?void 0:j.map(function(et){return{processId:et.context["@id"],paramValue:et.value.toString(),paramName:et.name,dateTime:(0,Q.p6)()}}),M=(p=v.lcaParamList)!==null&&p!==void 0&&p.length?v:{lcaParamList:tt.length?tt:void 0},Rt=f()(f()({},M),{},{loadName:E,productId:b});(0,lt.E)(Rt).then(function(et){typeof R=="function"&&R()}).catch(function(et){}).finally(function(){typeof s=="function"&&s()})}};(0,n.useEffect)(function(){S()},[]);var ut=function(){m.productId&&F(!0)},nt=function(p,E){l(function(b){return f()(f()({},b),{},a()({},E,p))})},it=function(){var L=xt()(ct()().mark(function p(){return ct()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:(0,lt.NF)(m.productId).then(function(tt){var M=JSON.parse(tt.paramDetail)[0]||[];U(JSON.stringify(M)==="{}"||!(M!=null&&M.parameters)?[]:M==null?void 0:M.parameters)}).catch(function(tt){}).finally();case 1:case"end":return b.stop()}},p)}));return function(){return L.apply(this,arguments)}}();(0,n.useEffect)(function(){m.productId&&it()},[m.productId]);var dt={loadName:"",productId:"",realDataInput:""},Tt=[{label:"\u78B3\u8DB3\u8FF9\u6279\u6B21",dataIndex:"loadName",render:function(){return(0,e.jsx)(Nt.Z,{value:m.loadName,onChange:function(E){return nt(E.target.value,"loadName")},id:"loadName",name:"loadName",maxLength:30,className:"w-full mb-[20px] mt-[10px] px-5 border border-[#DDDDDD]  h-[50px]  bg-[#F8F8F8] rounded-lg"})}},{label:"\u4EA7\u54C1\u7CFB\u7EDF",dataIndex:"productId",render:function(){return(0,e.jsx)(St.default,{value:m.productId,style:{height:"50px",borderColor:"#DDDDDD",backgroundColor:"#F8F8F8",width:"100%"},onChange:function(E){return nt(E,"productId")},options:(0,Q.ry)("name","id",q)})}},{label:"\u5B9E\u666F\u6570\u636E\u586B\u62A5",dataIndex:"realDataInput",render:function(){return(0,e.jsx)("div",{onClick:function(){return ut()},className:" flex cursor-pointer rounded-[4px] leading-4 text-[16px] mt-[10px] bg-[#F1F1F1] w-[84px] h-[24px]  text-center items-center justify-center ",children:"\u524D\u5F80\u586B\u5199"})}}];return N?null:(0,e.jsxs)(n.Fragment,{children:[(0,e.jsx)(mt.u_,{className:"rounded-lg",containerClassName:"mx-5 w-[640px]",titleClassName:"text-[20px] leading-5 font-bold",title:"\u65B0\u5EFA\u78B3\u8DB3\u8FF9\u7ED3\u679C",onClose:s,line:!0,bottomBtn:(0,e.jsxs)("div",{className:"flex flex-row justify-between gap-5 ",children:[(0,e.jsx)(T.u,{size:"large",onClick:s,defStyle:"btn-primary-1",className:"flex-1  font-normal  h-[50px] border-2 text-[18px]",children:"\u53D6\u6D88"}),(0,e.jsx)(T.u,{size:"large",className:"flex-1 h-[50px]  font-normal  text-[18px]",onClick:C,disabled:!m.productId||!m.loadName,children:"\u8BA1\u7B97\u78B3\u7ED3\u679C"})]}),children:(0,e.jsx)("div",{className:"mx-5 w-[640px] ",children:(0,e.jsx)(yt.Z,{size:"small",options:Tt,data:dt,optionEmptyText:"-",layout:"vertical",column:1,contentStyle:{color:"#999999",fontWeight:"400"},labelStyle:{color:"#000000",fontWeight:"400"}})})}),Y&&(0,e.jsx)(Dt,{realData:w,tableData:j,realArr:v.lcaParamList,onOpenModal:function(){return F(!1)}})]})},jt=Ct,W,ft=(W={},a()(W,-1,{color:"text-[red]",text:"\u8BA1\u7B97\u5931\u8D25"}),a()(W,0,{color:"text-[#FF9800]",text:"\u7B49\u5F85\u8BA1\u7B97"}),a()(W,1,{color:"text-green-2",text:"\u67E5\u770B\u7ED3\u679C"}),a()(W,2,{color:"text-blue-600",text:"\u6B63\u5728\u8BA1\u7B97"}),W);function Lt(){var X=(0,n.useState)(1),h=d()(X,2),s=h[0],R=h[1],g=(0,n.useState)(!1),D=d()(g,2),Y=D[0],F=D[1],k=(0,n.useState)(!1),O=d()(k,2),q=O[0],Z=O[1],c=(0,n.useRef)({inputData:"",data:""}),r=function(i){var o=i.param,N=i.paramDetail;c.current={inputData:o,data:N},Z(!0)},v=(0,n.useMemo)(function(){return[{title:"\u78B3\u8DB3\u8FF9\u6279\u6B21",dataIndex:"loadName",width:180,ellipsis:!0},{title:"\u5B9E\u666F\u6570\u636E",valueType:"option",width:120,render:function(i,o){return[(0,e.jsx)("div",{className:"flex justify-center whitespace-nowrap px-2.5 bg-[#F1F1F1] rounded",onClick:function(){return r(o)},children:(0,e.jsx)("span",{className:"cursor-pointer",children:"\u67E5\u770B\u5B9E\u666F\u6570\u636E"})},"key_look_real")]}},{title:"\u6279\u6B21\u7ED3\u679CID",dataIndex:"loadNumber",width:170,renderText:u.zL},{title:"\u4EA7\u54C1\u7CFB\u7EDF\u540D\u79F0",width:128,dataIndex:"productName",ellipsis:!0},{title:"\u7CFB\u7EDF\u4EA7\u54C1ID",dataIndex:"productUuid",width:170,renderText:u.zL},{title:"\u63CF\u8FF0",dataIndex:"productDescription",width:300,ellipsis:!0},{title:"\u64CD\u4F5C\u4EBA",dataIndex:"operator",width:100,ellipsis:!0},{title:"\u751F\u6210\u65F6\u95F4",dataIndex:"calculateSuccessTime",valueType:"dateTime",width:180},{title:"\u78B3\u8DB3\u8FF9\u7ED3\u679C",dataIndex:"state",width:130,render:function(i,o){var N,z;return(0,e.jsx)("div",{className:ot()({"cursor-pointer":o.state===1},(N=ft[o.state])===null||N===void 0?void 0:N.color),onClick:function(){o.state===1&&I.history.push("/main/tools/inventory/result?id=".concat(o.loadNumber))},children:(z=ft[o.state])===null||z===void 0?void 0:z.text})}},{title:"\u7EC4\u7EC7\u540D\u79F0",dataIndex:"orgName",width:130,ellipsis:!0},{title:"\u7EC4\u7EC7\u7F16\u53F7",dataIndex:"orgSerialNumber",width:130,ellipsis:!0}]},[]),w=(0,at.cc)(s,1e4),y=w.data,B=w.isLoading,j=w.mutate,U=(0,n.useMemo)(function(){return((y==null?void 0:y.records)||[]).map(function(l,i){return f()(f()({},l),{},{key:"key_inventory_"+i})})},[y]),V=(0,rt.b)(),K=(0,n.useMemo)(function(){return[{title:"\u53C2\u6570\u540D",dataIndex:"name",ellipsis:!0,width:200},{title:"\u8FC7\u7A0B\u540D\u79F0",dataIndex:"uuid",width:170},{title:"\u53C2\u8003\u503C",dataIndex:"optName",width:100}]},[]),m=(0,n.useMemo)(function(){var l;if(!c.current)return[];var i=(0,Q.OA)(c.current.data)||[],o=c.current.inputData,N=c.current.inputData?_.mapKeys(typeof o=="string"?(0,Q.OA)(o)||[]:o,function(S){return S.paramName}):{},z=((l=i[0])===null||l===void 0?void 0:l.parameters)||[];return z.map(function(S){var C;return[S.name,S.context.name,S.value,((C=N[S.name])===null||C===void 0?void 0:C.paramValue)||""]}).map(function(S){var C=d()(S,4),ut=C[0],nt=C[1],it=C[2],dt=C[3];return{name:ut,uuid:nt,optName:dt||it.toString()}})},[c.current]);return(0,e.jsxs)(x.Z,{title:"\u6211\u7684\u4EA7\u54C1\u78B3\u8DB3\u8FF9\u7ED3\u679C",extra:V?[(0,e.jsx)(T.u,{onClick:function(){return F(!0)},children:"\u65B0\u5EFA\u78B3\u8DB3\u8FF9\u7ED3\u679C"},"new_inventory")]:[],children:[(0,e.jsx)("div",{className:"bg-white",children:(0,e.jsx)(u.ZP,{columns:v,dataSource:U,loading:B,pagination:{pageSize:10,total:(y==null?void 0:y.total)||0,current:s,onChange:function(i){R(i)}}})}),Y&&(0,e.jsx)(jt,{openResultModal:function(){return F(!1)},getList:function(){R(1),s===1&&j()}}),q&&(0,e.jsx)(J.d,{isShow:!0,header:K,data:m,onClose:function(){return Z(!1)}})]})}var Et=Lt,Mt=function(){var X=(0,I.useLocation)(),h=X.pathname;return console.info("inventoryPage:",h),h!=="/main/tools/inventory"?(0,e.jsx)(I.Outlet,{}):(0,e.jsx)(Et,{})}},85193:function(st,$,t){t.d($,{S1:function(){return G},ZT:function(){return A},jU:function(){return d},on:function(){return f}});var A=function(){};function f(a){for(var x=[],u=1;u<arguments.length;u++)x[u-1]=arguments[u];a&&a.addEventListener&&a.addEventListener.apply(a,x)}function G(a){for(var x=[],u=1;u<arguments.length;u++)x[u-1]=arguments[u];a&&a.removeEventListener&&a.removeEventListener.apply(a,x)}var d=typeof window!="undefined",H=typeof navigator!="undefined"},76852:function(st,$,t){var A=t(79685),f=t(85193),G=["mousedown","touchstart"],d=function(H,a,x){x===void 0&&(x=G);var u=(0,A.useRef)(a);(0,A.useEffect)(function(){u.current=a},[a]),(0,A.useEffect)(function(){for(var T=function(I){var P=H.current;P&&!P.contains(I.target)&&u.current(I)},J=0,at=x;J<at.length;J++){var rt=at[J];(0,f.on)(document,rt,T)}return function(){for(var I=0,P=x;I<P.length;I++){var ot=P[I];(0,f.S1)(document,ot,T)}}},[x,H])};$.Z=d}}]);
