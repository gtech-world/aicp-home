"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[9725],{8242:function(rt,F,t){var T=t(68591),d=t.n(T),O=t(63342),u=function(a){var m=a.onClick,r=a.busy,C=a.btnText,V=a.btnClassName,W=a.prohibit;return(0,O.jsx)("div",{onClick:W?void 0:m,className:d()("flex hover:border-[#29953A] hover:text-[#29953A] border text-[#000000] rounded-[2px] leading-4 text-[14px]  w-[100px] h-[24px]  text-center items-center justify-center ",r?"cursor-not-allowed":"cursor-pointer",W?" border bg-[#F5F5F5] text-[#00000040] cursor-no-drop hover:border-[#F5F5F5] hover:text-[#D9D9D9]  ":"cursor-pointer",V),children:C})};F.Z=u},75631:function(rt,F,t){t.r(F),t.d(F,{default:function(){return jt}});var T=t(48651),d=t.n(T),O=t(86516),u=t.n(O),K=t(5677),a=t.n(K),m=t(64082),r=t(18842),C=t(9991),V=t(5053),W=t(8965),ot=t(76222),E=t(12564),$=t(68591),lt=t.n($),n=t(79685),ft=t(22786),ct=t.n(ft),pt=t(46299),xt=t.n(pt),mt=t(95968),ut=t(54916),X=t(81123),ht=t(48294),e=t(63342),gt=function(h){var v=h.onOpenModal,R=h.realData,g=h.tableData,D=h.realArr,k=(0,n.useState)(g),B=u()(k,2),q=B[0],z=B[1],tt=function(){for(var o,p=(o=document)===null||o===void 0?void 0:o.getElementById("realDataTable"),y=p.getElementsByTagName("tr"),N=[],P=0;P<y.length;P++){for(var L=[],J=y[P].getElementsByTagName("input"),U=0;U<J.length;U++){var Q=J[U].value;L.push(Q)}N.push(L)}var s=[];s=g==null?void 0:g.map(function(c,l){var I={processId:c.context["@id"],paramValue:N.slice(1)[l][0]||c.value.toString(),paramName:c.name,dateTime:(0,X.p6)()};return I});var i={lcaParamList:s};typeof v=="function"&&v(),typeof R=="function"&&R(i)};(0,n.useEffect)(function(){var f=g==null?void 0:g.map(function(o,p){var y;return D!=null&&D.length&&((y=D[p])===null||y===void 0?void 0:y.paramName)===o.name?d()(d()({},o),{},{inputValue:D[p].paramValue}):d()({},o)});z(f)},[D,g]);var H=[{title:"\u53C2\u6570\u540D",dataIndex:"name",width:"9rem",render:function(o){return(0,e.jsx)("div",{className:" flex items-center h-[33px] font-normal leading-[21px] text-[14px] ",children:o})}},{title:"\u8FC7\u7A0B\u540D\u79F0",dataIndex:"name",width:"7rem",render:function(o,p){return(0,e.jsx)("div",{className:"flex items-center  h-[33px] font-normal leading-[21px] text-[14px] ",children:p.context.name})}},{title:"\u53C2\u8003\u503C",width:"10rem",dataIndex:"value",render:function(o){return(0,e.jsx)("div",{className:"flex items-center h-[33px] font-normal leading-[21px] text-[14px] ",children:o})}},{title:"\u586B\u5165\u503C",width:"10rem",dataIndex:"createTime",render:function(o,p){return(0,e.jsx)("input",{defaultValue:p.inputValue,type:"number",className:"font-normal  leading-[21px] text-[14px] w-[10rem] h-[33px] "})}}];return(0,e.jsx)(mt.u_,{title:"\u5B9E\u666F\u6570\u636E\u586B\u62A5",containerClassName:"mx-5 max-w-[640px]",titleClassName:"text-[16px] leading-5 font-bold",onClose:typeof v=="function"&&v||void 0,line:!0,bottomBtn:(0,e.jsx)("div",{className:"mx-5 ",children:(0,e.jsxs)("div",{className:"flex flex-row justify-between gap-5 ",children:[(0,e.jsx)(C.u,{size:"large",onClick:typeof v=="function"&&v||void 0,defStyle:"btn-primary-1",className:"flex-1  font-normal  h-[50px] border-2 text-[18px]",children:"\u53D6\u6D88"}),(0,e.jsx)(C.u,{size:"large",className:"flex-1 h-[50px]  font-normal  text-[18px]",onClick:tt,children:"\u786E\u5B9A"})]})}),children:(0,e.jsx)("div",{className:" mx-5 w-[640px] max-h-[400px] overflow-y-auto ",children:(0,e.jsx)(ht.i,{columns:H,tableId:"realDataTable",data:q||[],isSetBorder:!0,maxHeight:"calc(100vh - 270px)",headerClassName:{background:"#FAFAFA",position:"sticky",top:0,fontWeight:"700",fontSize:"18px",lineHeight:"30px",height:"50px"}})})})},Dt=gt,yt=t(46284),Nt=t(3826),It=t(7698),St=t(8242),Ct={loadName:"",productId:""},Et=function(h){var v=h.openResultModal,R=h.getList,g=(0,n.useState)(!1),D=u()(g,2),k=D[0],B=D[1],q=(0,n.useState)([{name:"",id:""}]),z=u()(q,2),tt=z[0],H=z[1],f=(0,n.useState)({lcaParamList:[]}),o=u()(f,2),p=o[0],y=o[1],N=(0,n.useState)([]),P=u()(N,2),L=P[0],J=P[1],U=(0,n.useState)(Ct),Q=u()(U,2),s=Q[0],i=Q[1],c=(0,n.useState)(!0),l=u()(c,2),I=l[0],Z=l[1],S=function(){(0,ut.ev)().then(function(x){H(x||{name:"",id:""}),Z(!1)}).catch(function(x){}).finally()},M=function(){var x,b=s.loadName,w=s.productId;if(!(!b||!w)){var et=L==null?void 0:L.map(function(at){return{processId:at.context["@id"],paramValue:at.value.toString(),paramName:at.name,dateTime:(0,X.p6)()}}),A=(x=p.lcaParamList)!==null&&x!==void 0&&x.length?p:{lcaParamList:et.length?et:void 0},At=d()(d()({},A),{},{loadName:b,productId:w});(0,ut.E)(At).then(function(at){typeof R=="function"&&R()}).catch(function(at){}).finally(function(){typeof v=="function"&&v()})}};(0,n.useEffect)(function(){S()},[]);var it=function(){s.productId&&B(!0)},nt=function(x,b){i(function(w){return d()(d()({},w),{},a()({},b,x))})},dt=function(){var j=xt()(ct()().mark(function x(){return ct()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:(0,ut.NF)(s.productId).then(function(et){var A=JSON.parse(et.paramDetail)[0]||[];J(JSON.stringify(A)==="{}"||!(A!=null&&A.parameters)?[]:A==null?void 0:A.parameters)}).catch(function(et){}).finally();case 1:case"end":return w.stop()}},x)}));return function(){return j.apply(this,arguments)}}();(0,n.useEffect)(function(){s.productId&&dt()},[s.productId]);var st={loadName:"",productId:"",realDataInput:""},bt=[{label:"\u78B3\u8DB3\u8FF9\u6279\u6B21",dataIndex:"loadName",render:function(){return(0,e.jsx)(Nt.Z,{value:s.loadName,onChange:function(b){return nt(b.target.value,"loadName")},id:"loadName",name:"loadName",maxLength:30,style:{marginTop:"-5px"},className:"w-full mb-[20px] px-5 border border-[#DDDDDD]  h-[40px]  bg-[#F8F8F8] rounded-lg"})}},{label:"\u4EA7\u54C1\u7CFB\u7EDF",dataIndex:"productId",render:function(){return(0,e.jsx)(It.default,{value:s.productId,style:{height:"40px",borderColor:"#DDDDDD",backgroundColor:"#F8F8F8",width:"100%",marginTop:"-5px"},onChange:function(b){return nt(b,"productId")},options:(0,X.ry)("name","id",tt)})}},{label:"\u5B9E\u666F\u6570\u636E\u586B\u62A5",dataIndex:"realDataInput",render:function(){return(0,e.jsx)(St.Z,{onClick:function(){return it()},btnText:"\u524D\u5F80\u586B\u5199",prohibit:!s.productId})}}];return I?null:(0,e.jsxs)(n.Fragment,{children:[(0,e.jsx)(mt.u_,{className:"rounded-lg",containerClassName:"mx-5 w-[640px]",titleClassName:"text-[20px] leading-5 font-bold",title:"\u65B0\u5EFA\u78B3\u8DB3\u8FF9\u7ED3\u679C",onClose:v,line:!0,bottomBtn:(0,e.jsxs)("div",{className:"flex flex-row justify-between gap-5 ",children:[(0,e.jsx)(C.u,{size:"large",onClick:v,defStyle:"btn-primary-1",className:"flex-1  font-normal  h-[50px] border-2 text-[18px]",children:"\u53D6\u6D88"}),(0,e.jsx)(C.u,{size:"large",className:"flex-1 h-[50px]  font-normal  text-[18px]",onClick:M,disabled:!s.productId||!s.loadName,children:"\u8BA1\u7B97\u78B3\u7ED3\u679C"})]}),children:(0,e.jsx)("div",{className:"mx-5 w-[640px] ",children:(0,e.jsx)(yt.Z,{size:"small",options:bt,data:st,optionEmptyText:"-",layout:"vertical",column:1,contentStyle:{color:"#999999",fontWeight:"400"},labelStyle:{color:"#000000",fontWeight:"400"}})})}),k&&(0,e.jsx)(Dt,{realData:y,tableData:L,realArr:p.lcaParamList,onOpenModal:function(){return B(!1)}})]})},Mt=Et,G,vt=(G={},a()(G,-1,{color:"text-[red]",text:"\u8BA1\u7B97\u5931\u8D25"}),a()(G,0,{color:"text-[#FF9800]",text:"\u7B49\u5F85\u8BA1\u7B97"}),a()(G,1,{color:"text-green-2",text:"\u67E5\u770B\u7ED3\u679C"}),a()(G,2,{color:"text-blue-600",text:"\u6B63\u5728\u8BA1\u7B97"}),G);function Tt(){var Y=(0,n.useState)(1),h=u()(Y,2),v=h[0],R=h[1],g=(0,n.useState)(!1),D=u()(g,2),k=D[0],B=D[1],q=(0,n.useState)(!1),z=u()(q,2),tt=z[0],H=z[1],f=(0,n.useRef)({inputData:"",data:""}),o=function(c){var l=c.param,I=c.paramDetail;f.current={inputData:l,data:I},H(!0)},p=(0,n.useMemo)(function(){return[{title:"\u78B3\u8DB3\u8FF9\u6279\u6B21",dataIndex:"loadName",width:180,ellipsis:!0},{title:"\u5B9E\u666F\u6570\u636E",valueType:"option",width:120,render:function(c,l){return[(0,e.jsx)("div",{className:"flex justify-center whitespace-nowrap px-2.5 bg-[#F1F1F1] rounded",onClick:function(){return o(l)},children:(0,e.jsx)("span",{className:"cursor-pointer",children:"\u67E5\u770B\u5B9E\u666F\u6570\u636E"})},"key_look_real")]}},{title:"\u6279\u6B21\u7ED3\u679CID",dataIndex:"loadNumber",width:170,renderText:r.zL},{title:"\u4EA7\u54C1\u7CFB\u7EDF\u540D\u79F0",width:128,dataIndex:"productName",ellipsis:!0},{title:"\u7CFB\u7EDF\u4EA7\u54C1ID",dataIndex:"productUuid",width:170,renderText:r.zL},{title:"\u63CF\u8FF0",dataIndex:"productDescription",width:200,ellipsis:!0},{title:"\u64CD\u4F5C\u4EBA",dataIndex:"operator",width:100,ellipsis:!0},{title:"\u751F\u6210\u65F6\u95F4",dataIndex:"calculateSuccessTime",valueType:"dateTime",width:180},{title:"\u78B3\u8DB3\u8FF9\u7ED3\u679C",dataIndex:"state",width:130,render:function(c,l){var I,Z;return(0,e.jsx)("div",{className:lt()({"cursor-pointer":l.state===1},(I=vt[l.state])===null||I===void 0?void 0:I.color),onClick:function(){l.state===1&&E.history.push("/main/tools/inventory/result?id=".concat(l.loadNumber))},children:(Z=vt[l.state])===null||Z===void 0?void 0:Z.text})}},{title:"\u7EC4\u7EC7\u540D\u79F0",dataIndex:"orgName",width:130,ellipsis:!0},{title:"\u7EC4\u7EC7\u7F16\u53F7",dataIndex:"orgSerialNumber",width:130,ellipsis:!0}]},[]),y=(0,W.cc)(v,1e4),N=y.data,P=y.isLoading,L=y.mutate,J=(0,n.useMemo)(function(){return((N==null?void 0:N.records)||[]).map(function(i,c){return d()(d()({},i),{},{key:"key_inventory_"+c})})},[N]),U=(0,ot.b)(),Q=(0,n.useMemo)(function(){return[{title:"\u53C2\u6570\u540D",dataIndex:"name",ellipsis:!0,width:200},{title:"\u8FC7\u7A0B\u540D\u79F0",dataIndex:"uuid",width:170},{title:"\u53C2\u8003\u503C",dataIndex:"optName",width:100},{title:"\u8F93\u5165\u503C",dataIndex:"inputData",width:100}]},[]),s=(0,n.useMemo)(function(){var i;if(!f.current)return[];var c=(0,X.OA)(f.current.data)||[],l=f.current.inputData,I=f.current.inputData?_.mapKeys(typeof l=="string"?(0,X.OA)(l)||[]:l,function(S){return S.paramName}):{},Z=((i=c[0])===null||i===void 0?void 0:i.parameters)||[];return Z.map(function(S){var M;return[S.name,S.context.name,S.value,((M=I[S.name])===null||M===void 0?void 0:M.paramValue)||""]}).map(function(S){var M=u()(S,4),it=M[0],nt=M[1],dt=M[2],st=M[3];return{name:it,uuid:nt,optName:dt.toString(),inputData:st}})},[f.current]);return(0,e.jsxs)(m.Z,{title:"\u6211\u7684\u4EA7\u54C1\u78B3\u8DB3\u8FF9\u7ED3\u679C",extra:U?[(0,e.jsx)(C.u,{onClick:function(){return B(!0)},children:"\u65B0\u5EFA\u78B3\u8DB3\u8FF9\u7ED3\u679C"},"new_inventory")]:[],children:[(0,e.jsx)("div",{className:"bg-white",children:(0,e.jsx)(r.ZP,{columns:p,dataSource:J,loading:P,pagination:{pageSize:10,total:(N==null?void 0:N.total)||0,current:v,onChange:function(c){R(c)}}})}),k&&(0,e.jsx)(Mt,{openResultModal:function(){return B(!1)},getList:function(){R(1),v===1&&L()}}),tt&&(0,e.jsx)(V.d,{isShow:!0,header:Q,data:s,onClose:function(){return H(!1)}})]})}var Lt=Tt,jt=function(){var Y=(0,E.useLocation)(),h=Y.pathname;return console.info("inventoryPage:",h),h!=="/main/tools/inventory"?(0,e.jsx)(E.Outlet,{}):(0,e.jsx)(Lt,{})}},85193:function(rt,F,t){t.d(F,{S1:function(){return O},ZT:function(){return T},jU:function(){return u},on:function(){return d}});var T=function(){};function d(a){for(var m=[],r=1;r<arguments.length;r++)m[r-1]=arguments[r];a&&a.addEventListener&&a.addEventListener.apply(a,m)}function O(a){for(var m=[],r=1;r<arguments.length;r++)m[r-1]=arguments[r];a&&a.removeEventListener&&a.removeEventListener.apply(a,m)}var u=typeof window!="undefined",K=typeof navigator!="undefined"},76852:function(rt,F,t){var T=t(79685),d=t(85193),O=["mousedown","touchstart"],u=function(K,a,m){m===void 0&&(m=O);var r=(0,T.useRef)(a);(0,T.useEffect)(function(){r.current=a},[a]),(0,T.useEffect)(function(){for(var C=function(E){var $=K.current;$&&!$.contains(E.target)&&r.current(E)},V=0,W=m;V<W.length;V++){var ot=W[V];(0,d.on)(document,ot,C)}return function(){for(var E=0,$=m;E<$.length;E++){var lt=$[E];(0,d.S1)(document,lt,C)}}},[m,K])};F.Z=u}}]);
