"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7998],{64082:function(Q,N,e){var I=e(48651),l=e.n(I),A=e(38046),f=e.n(A),y=e(30541),u=e(33421),j=e(68591),x=e.n(j),P=e(63342),o=["className"];function r(M){var R=M.className,S=f()(M,o),d=(0,u.l)(function(p){var c=p.token;return{".ant-page-header":{padding:"1rem 1.5rem",backgroundColor:c.colorBgBase,".ant-breadcrumb":{fontSize:".875rem",marginBottom:"0.5rem"},".ant-page-header-heading-title":{fontSize:"1.25rem"}},".ant-pro-grid-content":{padding:"1.5rem",backgroundColor:"transparent",".ant-pro-page-container-children-content":{padding:0,paddingBlock:"0 !important"},".ant-pro-page-container-children-container":{paddingBlock:"0 !important",paddingInline:"0 !important"}}}});return(0,P.jsx)(y._z,l()({className:x()(R,d)},S))}N.Z=r},9991:function(Q,N,e){e.d(N,{u:function(){return S},z:function(){return R}});var I=e(5677),l=e.n(I),A=e(48651),f=e.n(A),y=e(38046),u=e.n(y),j=e(68591),x=e.n(j),P=e(68717),o=e(63342),r=["children","className"],M=["busy","disabled","className","defStyle","children"];function R(d){var p=d.children,c=d.className,O=u()(d,r);return(0,o.jsx)("button",f()(f()({},O),{},{className:x()(c),children:d.children}))}function S(d){var p,c=d.busy,O=d.disabled,X=d.className,z=d.defStyle,V=z===void 0?"btn-primary":z,$=d.children,m=u()(d,M);return(0,o.jsx)("button",f()(f()({className:x()(X,(p={},l()(p,V,!O),l()(p,"btn-disable",O),p))},m),{},{children:c?(0,o.jsx)(P.fCD,{className:"animate-spin"}):$}))}},2042:function(Q,N,e){e.d(N,{n:function(){return f},s:function(){return A}});var I=e(97207),l=e.n(I);function A(y){var u=l().groupBy(y,"flowId"),j=function x(P){P.forEach(function(o){if(o._child||(o._child=(o.childFlowIds||[]).map(function(M){return u[M][0]}),x(o._child)),o._child.length===0)o._depth=0;else{var r;o._depth=(((r=l().maxBy(o._child,"_depth"))===null||r===void 0?void 0:r._depth)||0)+1}})};j(y)}var f=function(u,j){var x=typeof u=="string"?[u]:u;return!!l().find(x,function(P){return P.startsWith(j)})}},83556:function(Q,N,e){e.r(N),e.d(N,{default:function(){return je}});var I=e(22786),l=e.n(I),A=e(46299),f=e.n(A),y=e(86516),u=e.n(y),j=e(64082),x=e(48651),P=e.n(x),o=e(42586),r=e(63342);function M(b){return(0,r.jsx)(o.Z,P()({opts:{locale:"en"},notMerge:!0,lazyUpdate:!0},b))}var R=e(9991),S=e(11e3),d=e(85223),p=e(54916),c=e(2042),O=e(81123),X=e(12564),z=e(68591),V=e.n(z),$=e(97207),m=e.n($),L=e(79685),ge=e(5490),xe=e(18812);function q(b){var W=b.children,D=b.tit,ee=b.className;return(0,r.jsxs)("div",{className:V()("for2pdf-item flex w-full flex-col bg-white min-h-[6.25rem] border-t-[3px] border-solid border-green-2",ee),style:{boxShadow:"0px 2px 10px 0px rgba(26, 62, 31, 0.10)"},children:[(0,r.jsx)("div",{className:"w-full h-[4.1875rem] flex justify-center items-center text-xl font-semibold text-black",style:{background:"linear-gradient(180deg, rgba(41, 149, 58, 0.12) 0%, rgba(41, 149, 58, 0) 100%)"},children:D}),W]})}function F(b){var W=b.tit,D=b.value;return(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("div",{className:"flex gap-2.5 items-center text-green-2 text-base",children:[(0,r.jsx)("div",{className:"w-1 h-1 shrink-0 rounded-sm bg-green-2 overflow-hidden"}),(0,r.jsx)("span",{className:"whitespace-nowrap",children:W})]}),(0,r.jsx)("div",{className:"text-base text-gray-6 text-right",children:D})]})}function be(){var b=(0,X.useSearchParams)(),W=u()(b,1),D=W[0],ee=(0,L.useState)(!1),de=u()(ee,2),ie=de[0],ce=de[1],Pe=(0,L.useState)(),me=u()(Pe,2),k=me[0],De=me[1],Be=(0,L.useState)(!0),_e=u()(Be,2),Ce=_e[0],Ne=_e[1],Me=function(){var B=f()(l()().mark(function h(){var s,i,_;return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(D.get("id")){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,(0,p.fF)(D.get("id"));case 4:if(s=n.sent,s){n.next=7;break}return n.abrupt("return");case 7:return n.next=9,(0,p.Yp)(s.modelId);case 9:i=n.sent,_=i.modelBomInfo,De({lca:s,bominfo:_}),Ne(!1);case 13:case"end":return n.stop()}},h)}));return function(){return B.apply(this,arguments)}}();(0,L.useEffect)(function(){Me()},[D.get("id")]);var re=(0,L.useMemo)(function(){var B=[],h="",s=["",""],i={};if(k){var _=k.lca,E=k.bominfo,n=(0,O.OA)(_.lcaResult);if(n){var Z,g,ne,te,ae,oe,ve=(((Z=n.extra)===null||Z===void 0?void 0:Z.targetAmount)||"").split("Item(s)");B={productSystemName:(g=n.extra)===null||g===void 0?void 0:g.productSystemName,methodName:(ne=n.extra)===null||ne===void 0?void 0:ne.methodName,targetName:ve[1]||((te=n.extra)===null||te===void 0?void 0:te.productSystemName),targetAmount:"".concat(Math.round(ve[0]||1)," (\u4EF6)"),calculateSuccessTime:_.calculateSuccessTime,loadNumber:_.loadNumber,loadName:_.loadName},h=n.totalImpacts&&((ae=n.totalImpacts[0])===null||ae===void 0?void 0:ae.impact.referenceUnit)||"";var Ae=m().round(n.totalResult||((oe=n.treeNode)===null||oe===void 0?void 0:oe.result)||0,2);s=["".concat(Ae||0),h]}var Y=(0,O.OA)(E),pe=(0,O.OA)(_.lcaTagResult);if(Y&&pe){var H=m().groupBy(pe,"flowId"),Re=m().groupBy(Y,"flowId");(0,c.s)(Y);var Te=Y;i={padding:20,tooltip:{trigger:"item",formatter:function(a){var v="".concat(a.name," ").concat(a.value,"(").concat(h,")");return a.marker?"".concat(a.marker," ").concat(v):v}},series:{type:"sankey",data:[],links:[]}};var Se=function(a){return(0,c.n)(a.tagType,"STAGE01")?"\u4F7F\u7528\u73AF\u8282":(0,c.n)(a.tagType,"STAGE02")?"\u8FD0\u8F93\u9500\u552E\u73AF\u8282":(0,c.n)(a.tagType,"STAGE03")?"\u751F\u4EA7\u5236\u9020\u73AF\u8282":""},Le=function(a){if((0,c.n)(a.tagType,"REFERENCE"))return"\u4F7F\u7528\u73AF\u8282";if((0,c.n)(a.tagType,"STAGE")){if(a._depth===1)return"\u751F\u4EA7\u5236\u9020\u73AF\u8282";if(a._depth===2)return"\u8FD0\u8F93\u9500\u552E\u73AF\u8282"}return""},T={};Te.forEach(function(t){var a;(0,c.n)(t.tagType,"REFERENCE")&&(B.targetName=t.flowName);var v=i.series.links,C=i.series.data,Ee=((a=m().first(H[t.flowId]))===null||a===void 0?void 0:a.result)||0;T[t.flowName]||(T[t.flowName]=!0,C==null||C.push({name:t.flowName,value:m().round(Ee,2),depth:t._depth})),t.childFlowIds&&t.childFlowIds.length&&t.childFlowIds.forEach(function(J){var G=m().first(H[J]),le=m().first(Re[J]);if(le&&G){var ue=m().first(H[le.flowId]),Fe=m().round((ue==null?void 0:ue.result)||0,2);v==null||v.push({target:t.flowName,source:le.flowName,value:Fe})}});var se=m().round(Ee-m().sumBy(t.childFlowIds||[],function(J){var G;return(G=H[J][0])===null||G===void 0?void 0:G.result}),2),K=Se(t);if(K&&t._depth>0)T[K]||(T[K]=!0,C==null||C.push({name:K,depth:t._depth-1})),v==null||v.push({target:t.flowName,source:K,value:se});else if(se>0&&t._depth>0){var w=Le(t);w&&(T[w]||(T[w]=!0,C==null||C.push({name:w,depth:t._depth-1})),v==null||v.push({target:t.flowName,source:w,value:se}))}})}}return{generalInfo:B,carbonResult:s,chartData:i}},[k]),U=re.generalInfo,fe=re.carbonResult,he=re.chartData,Oe=function(){var B=f()(l()().mark(function h(){var s,i,_,E,n;return l()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!(!D.get("id")||ie)){g.next=2;break}return g.abrupt("return",!1);case 2:return ce(!0),g.next=5,(0,p.LW)(D.get("id"));case 5:s=g.sent,s.headers&&(i=s.headers.get("content-disposition"),i&&(_=i.match(/filename=(.+)/),_&&(ce(!1),E=new Blob([s.data]),n=document.createElement("a"),n.download=_[1],n.style.display="none",n.href=URL.createObjectURL(E),document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n))));case 7:case"end":return g.stop()}},h)}));return function(){return B.apply(this,arguments)}}(),Ie=function(){var B=f()(l()().mark(function h(){var s,i;return l()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(s=document.getElementById("inventory-result-content"),s){E.next=3;break}return E.abrupt("return");case 3:i="PCF-".concat(U.loadName,".pdf"),(0,ge.YM)(s).then(function(n){return xe.createPdf({content:[{image:n,width:515}]})}).then(function(n){return n.download(i)}).catch(console.error);case 5:case"end":return E.stop()}},h)}));return function(){return B.apply(this,arguments)}}();return(0,r.jsx)(j.Z,{title:"\u78B3\u8DB3\u8FF9\u7ED3\u679C",className:"text-lg text-black",extra:[(0,r.jsx)(R.u,{onClick:Ie,children:"\u5C06\u6B64\u9875\u9762\u751F\u6210PDF"},"key_export_pdf"),(0,r.jsx)(R.u,{onClick:Oe,busy:ie,children:"\u5BFC\u51FA\u8BA1\u7B97\u660E\u7EC6Excel"},"key_export_excel")],children:Ce?(0,r.jsx)("div",{className:"h-[100vh] w-full items-center",children:(0,r.jsx)(S.g,{})}):(0,r.jsx)("div",{className:"mo:break-all max-w-[1200px]",id:"inventory-result-content",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-5 mo:grid-cols-1",children:[(0,r.jsx)(q,{tit:"\u4EA7\u54C1\u78B3\u8DB3\u8FF9",children:(0,r.jsxs)("div",{className:"flex items-center flex-1 px-9 mb-9",children:[(0,r.jsx)(d.vD,{}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col justify-center items-center whitespace-nowrap",children:[(0,r.jsx)("span",{className:"font-semibold text-green-2 text-4xl",children:fe[0]}),(0,r.jsx)("span",{className:"font-semibold text-black text-base",children:fe[1]})]})]})}),(0,r.jsx)(q,{tit:"\u78B3\u8DB3\u8FF9\u8BC4\u4EF7\u8BE6\u60C5",children:(0,r.jsxs)("div",{className:"flex flex-col gap-3 mx-5 mt-3 mb-9",children:[(0,r.jsx)(F,{tit:"\u76EE\u6807\u4EA7\u54C1",value:U.targetName}),(0,r.jsx)(F,{tit:"\u76EE\u6807\u4EA7\u54C1\u6570\u91CF",value:U.targetAmount}),(0,r.jsx)(F,{tit:"\u78B3\u8DB3\u8FF9\u6279\u6B21",value:U.loadName}),(0,r.jsx)(F,{tit:"\u73AF\u5883\u5F71\u54CD\u8BC4\u4EF7\u65B9\u6CD5",value:"IPCC 2021,GWP 100"}),(0,r.jsx)(F,{tit:"\u8BA1\u7B97\u7ED3\u679C\u751F\u6210\u65F6\u95F4",value:U.calculateSuccessTime})]})}),(0,r.jsx)(q,{tit:"\u751F\u547D\u5468\u671F\u73AF\u8282\u660E\u7EC6\u7ED3\u679C",className:"col-span-2 mo:col-span-1",children:he&&(0,r.jsx)(M,{className:"w-full !h-[360px]",option:he})})]})})})}var ye=be,je=ye}}]);
