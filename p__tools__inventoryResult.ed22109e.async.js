"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7998],{64082:function(G,b,e){var C=e(48651),a=e.n(C),M=e(38046),v=e.n(M),x=e(30541),o=e(33421),P=e(68591),c=e.n(P),m=e(63342),s=["className"];function n(f){var R=f.className,l=v()(f,s),O=(0,o.l)(function(h){var i=h.token;return{".ant-page-header":{padding:"1rem 1.5rem",paddingBlock:"1rem !important",paddingInline:"1.5rem !important",backgroundColor:i.colorBgBase,".ant-breadcrumb":{fontSize:".875rem",paddingBlockStart:"0 !important"},".ant-page-header-heading-title":{fontSize:"1.25rem"}},".ant-pro-grid-content":{padding:"1.5rem",backgroundColor:"transparent",".ant-pro-page-container-children-content":{padding:0,paddingBlock:"0 !important"},".ant-pro-page-container-children-container":{paddingBlock:"0 !important",paddingInline:"0 !important"}}}});return(0,m.jsx)(x._z,a()({className:c()(R,O)},l))}b.Z=n},9991:function(G,b,e){e.d(b,{u:function(){return R},z:function(){return f}});var C=e(48651),a=e.n(C),M=e(38046),v=e.n(M),x=e(68591),o=e.n(x),P=e(68717),c=e(31887),m=e(63342),s=["children","className"],n=["busy","type","className","defStyle","children"];function f(l){var O=l.children,h=l.className,i=v()(l,s);return(0,m.jsx)("button",a()(a()({},i),{},{className:o()(h),children:l.children}))}function R(l){var O=l.busy,h=l.type,i=h===void 0?"primary":h,L=l.className,k=l.defStyle,X=k===void 0?"btn-primary":k,V=l.children,$=v()(l,n);return(0,m.jsx)(c.ZP,a()(a()({type:X==="btn-primary-1"?"default":i,className:o()(L,"leading-none !shadow-none",{})},$),{},{children:O?(0,m.jsx)(P.fCD,{className:"animate-spin mx-auto"}):V}))}},11e3:function(G,b,e){e.d(b,{I:function(){return n},g:function(){return s}});var C=e(48651),a=e.n(C),M=e(38046),v=e.n(M),x=e(68591),o=e.n(x),P=e(26082),c=e(63342),m=["className","color","size"];function s(f){var R=f.className,l=f.color,O=f.size,h=O===void 0?"":O,i=v()(f,m);return(0,c.jsx)("div",a()(a()({},i),{},{className:o()("text-black w-full h-full flex items-center justify-center",R),children:(0,c.jsx)(P.uur,{color:l,style:h?{fontSize:h}:{},className:"text-[3.125rem] animate-spin"})}))}function n(){return(0,c.jsx)(s,{className:"fixed z-50 left-0 top-0 w-full !h-full bg-black/25"})}},2042:function(G,b,e){e.d(b,{n:function(){return v},s:function(){return M}});var C=e(97207),a=e.n(C);function M(x){var o=a().groupBy(x,"flowId"),P=function c(m){m.forEach(function(s){if(s._child||(s._child=(s.childFlowIds||[]).map(function(f){return o[f][0]}),c(s._child)),s._child.length===0)s._depth=0;else{var n;s._depth=(((n=a().maxBy(s._child,"_depth"))===null||n===void 0?void 0:n._depth)||0)+1}})};P(x)}var v=function(o,P){var c=typeof o=="string"?[o]:o;return!!a().find(c,function(m){return m.startsWith(P)})}},83556:function(G,b,e){e.r(b),e.d(b,{default:function(){return je}});var C=e(22786),a=e.n(C),M=e(46299),v=e.n(M),x=e(86516),o=e.n(x),P=e(64082),c=e(48651),m=e.n(c),s=e(42586),n=e(63342);function f(B){return(0,n.jsx)(s.Z,m()({opts:{locale:"en"},notMerge:!0,lazyUpdate:!0},B))}var R=e(9991),l=e(11e3),O=e(4151),h=e(54916),i=e(2042),L=e(81123),k=e(12564),X=e(68591),V=e.n(X),$=e(97207),D=e.n($),S=e(79685),ge=e(5490),xe=e(18812);function q(B){var U=B.children,N=B.tit,ee=B.className;return(0,n.jsxs)("div",{className:V()("for2pdf-item flex w-full flex-col bg-white min-h-[6.25rem] border-t-[3px] border-solid border-green-2",ee),style:{boxShadow:"0px 2px 10px 0px rgba(26, 62, 31, 0.10)"},children:[(0,n.jsx)("div",{className:"w-full h-[4.1875rem] flex justify-center items-center text-xl font-semibold text-black",style:{background:"linear-gradient(180deg, rgba(41, 149, 58, 0.12) 0%, rgba(41, 149, 58, 0) 100%)"},children:N}),U]})}function W(B){var U=B.tit,N=B.value;return(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("div",{className:"flex gap-2.5 items-center text-green-2 text-base",children:[(0,n.jsx)("div",{className:"w-1 h-1 overflow-hidden rounded-sm shrink-0 bg-green-2"}),(0,n.jsx)("span",{className:"whitespace-nowrap",children:U})]}),(0,n.jsx)("div",{className:"text-base text-right text-gray-6",children:N})]})}function Pe(){var B=(0,k.useSearchParams)(),U=o()(B,1),N=U[0],ee=(0,S.useState)(!1),de=o()(ee,2),ie=de[0],_e=de[1],ye=(0,S.useState)(),ce=o()(ye,2),Z=ce[0],be=ce[1],Be=(0,S.useState)(!0),me=o()(Be,2),Ce=me[0],Me=me[1],Oe=function(){var I=v()(a()().mark(function E(){var d,_,p;return a()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(N.get("id")){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,(0,h.fF)(N.get("id"));case 4:if(d=r.sent,d){r.next=7;break}return r.abrupt("return");case 7:return r.next=9,(0,h.Yp)(d.modelId);case 9:_=r.sent,p=_.modelBomInfo,be({lca:d,bominfo:p}),Me(!1);case 13:case"end":return r.stop()}},E)}));return function(){return I.apply(this,arguments)}}();(0,S.useEffect)(function(){Oe()},[N.get("id")]);var ne=(0,S.useMemo)(function(){var I=[],E="",d=["",""],_={};if(Z){var p=Z.lca,j=Z.bominfo,r=(0,L.OA)(p.lcaResult);if(r){var Y,y,re,te,ae,oe,pe=(((Y=r.extra)===null||Y===void 0?void 0:Y.targetAmount)||"").split("Item(s)");I={productSystemName:(y=r.extra)===null||y===void 0?void 0:y.productSystemName,methodName:(re=r.extra)===null||re===void 0?void 0:re.methodName,targetName:pe[1]||((te=r.extra)===null||te===void 0?void 0:te.productSystemName),targetAmount:"".concat(Math.round(pe[0]||1)," (\u4EF6)"),calculateSuccessTime:p.calculateSuccessTime,loadNumber:p.loadNumber,loadName:p.loadName},E=r.totalImpacts&&((ae=r.totalImpacts[0])===null||ae===void 0?void 0:ae.impact.referenceUnit)||"";var Ae=D().round(r.totalResult||((oe=r.treeNode)===null||oe===void 0?void 0:oe.result)||0,2);d=["".concat(Ae||0),E]}var H=(0,L.OA)(j),ve=(0,L.OA)(p.lcaTagResult);if(H&&ve){var J=D().groupBy(ve,"flowId"),Re=D().groupBy(H,"flowId");(0,i.s)(H);var Te=H;_={padding:20,tooltip:{trigger:"item",formatter:function(u){var g="".concat(u.name," ").concat(u.value,"(").concat(E,")");return u.marker?"".concat(u.marker," ").concat(g):g}},series:{type:"sankey",data:[],links:[]}};var Le=function(u){return(0,i.n)(u.tagType,"STAGE01")?"\u4F7F\u7528\u73AF\u8282":(0,i.n)(u.tagType,"STAGE02")?"\u8FD0\u8F93\u9500\u552E\u73AF\u8282":(0,i.n)(u.tagType,"STAGE03")?"\u751F\u4EA7\u5236\u9020\u73AF\u8282":""},Se=function(u){if((0,i.n)(u.tagType,"REFERENCE"))return"\u4F7F\u7528\u73AF\u8282";if((0,i.n)(u.tagType,"STAGE")){if(u._depth===1)return"\u751F\u4EA7\u5236\u9020\u73AF\u8282";if(u._depth===2)return"\u8FD0\u8F93\u9500\u552E\u73AF\u8282"}return""},T={};Te.forEach(function(t){var u;(0,i.n)(t.tagType,"REFERENCE")&&(I.targetName=t.flowName);var g=_.series.links,A=_.series.data,Ee=((u=D().first(J[t.flowId]))===null||u===void 0?void 0:u.result)||0;T[t.flowName]||(T[t.flowName]=!0,A==null||A.push({name:t.flowName,value:D().round(Ee,2),depth:t._depth})),t.childFlowIds&&t.childFlowIds.length&&t.childFlowIds.forEach(function(Q){var z=D().first(J[Q]),le=D().first(Re[Q]);if(le&&z){var ue=D().first(J[le.flowId]),We=D().round((ue==null?void 0:ue.result)||0,2);g==null||g.push({target:t.flowName,source:le.flowName,value:We})}});var se=D().round(Ee-D().sumBy(t.childFlowIds||[],function(Q){var z;return(z=J[Q][0])===null||z===void 0?void 0:z.result}),2),K=Le(t);if(K&&t._depth>0)T[K]||(T[K]=!0,A==null||A.push({name:K,depth:t._depth-1})),g==null||g.push({target:t.flowName,source:K,value:se});else if(se>0&&t._depth>0){var w=Se(t);w&&(T[w]||(T[w]=!0,A==null||A.push({name:w,depth:t._depth-1})),g==null||g.push({target:t.flowName,source:w,value:se}))}})}}return{generalInfo:I,carbonResult:d,chartData:_}},[Z]),F=ne.generalInfo,fe=ne.carbonResult,he=ne.chartData,Ne=function(){var I=v()(a()().mark(function E(){var d,_,p,j,r;return a()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(!N.get("id")||ie)){y.next=2;break}return y.abrupt("return",!1);case 2:return _e(!0),y.next=5,(0,h.LW)(N.get("id"));case 5:d=y.sent,d.headers&&(_=d.headers.get("content-disposition"),_&&(p=_.match(/filename=(.+)/),p&&(_e(!1),j=new Blob([d.data]),r=document.createElement("a"),r.download=p[1],r.style.display="none",r.href=URL.createObjectURL(j),document.body.appendChild(r),r.click(),URL.revokeObjectURL(r.href),document.body.removeChild(r))));case 7:case"end":return y.stop()}},E)}));return function(){return I.apply(this,arguments)}}(),Ie=function(){var I=v()(a()().mark(function E(){var d,_;return a()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(d=document.getElementById("inventory-result-content"),d){j.next=3;break}return j.abrupt("return");case 3:_="PCF-".concat(F.loadName,".pdf"),(0,ge.YM)(d).then(function(r){return xe.createPdf({content:[{image:r,width:515}]})}).then(function(r){return r.download(_)}).catch(console.error);case 5:case"end":return j.stop()}},E)}));return function(){return I.apply(this,arguments)}}();return(0,n.jsx)(P.Z,{title:"\u78B3\u8DB3\u8FF9\u7ED3\u679C",className:"text-lg text-black",extra:[(0,n.jsx)(R.u,{className:"w-[142px]",onClick:Ie,children:"\u5C06\u6B64\u9875\u9762\u751F\u6210PDF"},"key_export_pdf"),(0,n.jsx)(R.u,{className:"w-[149px]",onClick:Ne,busy:ie,children:"\u5BFC\u51FA\u8BA1\u7B97\u660E\u7EC6Excel"},"key_export_excel")],children:Ce?(0,n.jsx)("div",{className:"h-[100vh] w-full items-center",children:(0,n.jsx)(l.g,{})}):(0,n.jsx)("div",{className:"mo:break-all max-w-[1200px]",id:"inventory-result-content",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-5 mo:grid-cols-1",children:[(0,n.jsx)(q,{tit:"\u4EA7\u54C1\u78B3\u8DB3\u8FF9",children:(0,n.jsxs)("div",{className:"flex items-center flex-1 px-9 mb-9",children:[(0,n.jsx)(O.vD,{}),(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center flex-1 whitespace-nowrap",children:[(0,n.jsx)("span",{className:"text-4xl font-semibold text-green-2",children:fe[0]}),(0,n.jsx)("span",{className:"text-base font-semibold text-black",children:fe[1]})]})]})}),(0,n.jsx)(q,{tit:"\u78B3\u8DB3\u8FF9\u8BC4\u4EF7\u8BE6\u60C5",children:(0,n.jsxs)("div",{className:"flex flex-col gap-3 mx-5 mt-3 mb-9",children:[(0,n.jsx)(W,{tit:"\u76EE\u6807\u4EA7\u54C1",value:F.targetName}),(0,n.jsx)(W,{tit:"\u76EE\u6807\u4EA7\u54C1\u6570\u91CF",value:F.targetAmount}),(0,n.jsx)(W,{tit:"\u78B3\u8DB3\u8FF9\u6279\u6B21",value:F.loadName}),(0,n.jsx)(W,{tit:"\u73AF\u5883\u5F71\u54CD\u8BC4\u4EF7\u65B9\u6CD5",value:"IPCC 2021,GWP 100"}),(0,n.jsx)(W,{tit:"\u8BA1\u7B97\u7ED3\u679C\u751F\u6210\u65F6\u95F4",value:F.calculateSuccessTime})]})}),(0,n.jsx)(q,{tit:"\u751F\u547D\u5468\u671F\u73AF\u8282\u660E\u7EC6\u7ED3\u679C",className:"col-span-2 mo:col-span-1",children:he&&(0,n.jsx)(f,{className:"w-full !h-[360px]",option:he})})]})})})}var De=Pe,je=De}}]);
