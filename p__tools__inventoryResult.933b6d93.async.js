"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7998],{64082:function(Q,B,e){var O=e(48651),u=e.n(O),M=e(38046),f=e.n(M),x=e(30541),s=e(33421),b=e(68591),E=e.n(b),j=e(63342),o=["className"];function n(C){var A=C.className,T=f()(C,o),l=(0,s.l)(function(h){var d=h.token;return{".ant-page-header":{padding:"1rem 1.5rem",backgroundColor:d.colorBgBase,".ant-breadcrumb":{fontSize:".875rem",marginBottom:"0.5rem"},".ant-page-header-heading-title":{fontSize:"1.25rem"}},".ant-pro-grid-content":{padding:"1.5rem",backgroundColor:"transparent",".ant-pro-page-container-children-content":{padding:0,paddingBlock:"0 !important"},".ant-pro-page-container-children-container":{paddingBlock:"0 !important",paddingInline:"0 !important"}}}});return(0,j.jsx)(x._z,u()({className:E()(A,l)},T))}B.Z=n},9991:function(Q,B,e){e.d(B,{u:function(){return T},z:function(){return A}});var O=e(5677),u=e.n(O),M=e(48651),f=e.n(M),x=e(38046),s=e.n(x),b=e(68591),E=e.n(b),j=e(68717),o=e(63342),n=["children","className"],C=["busy","disabled","className","defStyle","children"];function A(l){var h=l.children,d=l.className,N=s()(l,n);return(0,o.jsx)("button",f()(f()({},N),{},{className:E()(d),children:l.children}))}function T(l){var h,d=l.busy,N=l.disabled,X=l.className,G=l.defStyle,V=G===void 0?"btn-primary":G,$=l.children,i=s()(l,C);return(0,o.jsx)("button",f()(f()({className:E()(X,(h={},u()(h,V,!N),u()(h,"btn-disable",N),h))},i),{},{children:d?(0,o.jsx)(j.fCD,{className:"animate-spin"}):$}))}},2042:function(Q,B,e){e.d(B,{n:function(){return f},s:function(){return M}});var O=e(97207),u=e.n(O);function M(x){var s=u().groupBy(x,"flowId"),b=function E(j){j.forEach(function(o){if(o._child||(o._child=(o.childFlowIds||[]).map(function(C){return s[C][0]}),E(o._child)),o._child.length===0)o._depth=0;else{var n;o._depth=(((n=u().maxBy(o._child,"_depth"))===null||n===void 0?void 0:n._depth)||0)+1}})};b(x)}var f=function(s,b){var E=typeof s=="string"?[s]:s;return!!u().find(E,function(j){return j.startsWith(b)})}},83556:function(Q,B,e){e.r(B),e.d(B,{default:function(){return je}});var O=e(22786),u=e.n(O),M=e(46299),f=e.n(M),x=e(86516),s=e.n(x),b=e(64082),E=e(48651),j=e.n(E),o=e(42586),n=e(63342);function C(g){return(0,n.jsx)(o.Z,j()({opts:{locale:"en"},notMerge:!0,lazyUpdate:!0},g))}var A=e(9991),T=e(11e3),l=e(85223),h=e(54916),d=e(2042),N=e(81123),X=e(49759),G=e(68591),V=e.n(G),$=e(97207),i=e.n($),S=e(79685);function q(g){var W=g.children,y=g.tit,ee=g.className;return(0,n.jsxs)("div",{className:V()("flex w-full flex-col bg-white min-h-[6.25rem]",ee),style:{boxShadow:"0px 3px 0px 0px #29953A inset, 0px 2px 10px 0px rgba(26, 62, 31, 0.10)"},children:[(0,n.jsx)("div",{className:"w-full h-[4.1875rem] flex justify-center items-center text-xl font-semibold text-black",style:{background:"linear-gradient(180deg, rgba(41, 149, 58, 0.12) 0%, rgba(41, 149, 58, 0) 100%)"},children:y}),W]})}function L(g){var W=g.tit,y=g.value;return(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("div",{className:"flex gap-2.5 items-center text-green-2 text-base",children:[(0,n.jsx)("div",{className:"w-1 h-1 shrink-0 rounded-sm bg-green-2 overflow-hidden"}),(0,n.jsx)("span",{className:"whitespace-nowrap",children:W})]}),(0,n.jsx)("div",{className:"text-base text-gray-6 text-right",children:y})]})}function xe(){var g=(0,X.useSearchParams)(),W=s()(g,1),y=W[0],ee=(0,S.useState)(!1),ie=s()(ee,2),ne=ie[0],ce=ie[1],ye=(0,S.useState)(),_e=s()(ye,2),z=_e[0],De=_e[1],Pe=(0,S.useState)(!0),me=s()(Pe,2),Be=me[0],Ce=me[1],Ne=function(){var I=f()(u()().mark(function D(){var c,v,_;return u()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(y.get("id")){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,(0,h.fF)(y.get("id"));case 4:if(c=r.sent,c){r.next=7;break}return r.abrupt("return");case 7:return r.next=9,(0,h.Yp)(c.modelId);case 9:v=r.sent,_=v.modelBomInfo,De({lca:c,bominfo:_}),Ce(!1);case 13:case"end":return r.stop()}},D)}));return function(){return I.apply(this,arguments)}}();(0,S.useEffect)(function(){Ne()},[y.get("id")]);var re=(0,S.useMemo)(function(){var I=[],D="",c=["",""],v={};if(z){var _=z.lca,F=z.bominfo,r=(0,N.OA)(_.lcaResult);if(r){var Z,p,ae,te,oe,se,pe=(((Z=r.extra)===null||Z===void 0?void 0:Z.targetAmount)||"").split("Item(s)");I={productSystemName:(p=r.extra)===null||p===void 0?void 0:p.productSystemName,methodName:(ae=r.extra)===null||ae===void 0?void 0:ae.methodName,targetName:pe[1]||((te=r.extra)===null||te===void 0?void 0:te.productSystemName),targetAmount:"".concat(Math.round(pe[0]||1)," (\u4EF6)"),calculateSuccessTime:_.calculateSuccessTime,loadNumber:_.loadNumber,loadName:_.loadName},D=r.totalImpacts&&((oe=r.totalImpacts[0])===null||oe===void 0?void 0:oe.impact.referenceUnit)||"";var Oe=i().round(r.totalResult||((se=r.treeNode)===null||se===void 0?void 0:se.result)||0,2);c=["".concat(Oe||0),D]}var Y=(0,N.OA)(F),Ee=(0,N.OA)(_.lcaTagResult);if(Y&&Ee){var H=i().groupBy(Ee,"flowId"),Me=i().groupBy(Y,"flowId");(0,d.s)(Y);var Ie=Y;v={padding:20,tooltip:{trigger:"item",formatter:function(t){var m="".concat(t.name," ").concat(t.value,"(").concat(D,")");return t.marker?"".concat(t.marker," ").concat(m):m}},series:{type:"sankey",data:[],links:[]}};var Ae=function(t){return(0,d.n)(t.tagType,"STAGE01")?"\u4F7F\u7528\u73AF\u8282":(0,d.n)(t.tagType,"STAGE02")?"\u8FD0\u8F93\u9500\u552E\u73AF\u8282":(0,d.n)(t.tagType,"STAGE03")?"\u751F\u4EA7\u5236\u9020\u73AF\u8282":""},Re=function(t){if((0,d.n)(t.tagType,"REFERENCE"))return"\u4F7F\u7528\u73AF\u8282";if((0,d.n)(t.tagType,"STAGE")){if(t._depth===1)return"\u751F\u4EA7\u5236\u9020\u73AF\u8282";if(t._depth===2)return"\u8FD0\u8F93\u9500\u552E\u73AF\u8282"}return""},R={};Ie.forEach(function(a){var t;(0,d.n)(a.tagType,"REFERENCE")&&(I.targetName=a.flowName);var m=v.series.links,P=v.series.data,ge=((t=i().first(H[a.flowId]))===null||t===void 0?void 0:t.result)||0;R[a.flowName]||(R[a.flowName]=!0,P==null||P.push({name:a.flowName,value:i().round(ge,2),depth:a._depth})),a.childFlowIds&&a.childFlowIds.length&&a.childFlowIds.forEach(function(J){var w=i().first(H[J]),ue=i().first(Me[J]);if(ue&&w){var de=i().first(H[ue.flowId]),Te=i().round((de==null?void 0:de.result)||0,2);m==null||m.push({target:a.flowName,source:ue.flowName,value:Te})}});var le=i().round(ge-i().sumBy(a.childFlowIds||[],function(J){var w;return(w=H[J][0])===null||w===void 0?void 0:w.result}),2),U=Ae(a);if(U&&a._depth>0)R[U]||(R[U]=!0,P==null||P.push({name:U,depth:a._depth-1})),m==null||m.push({target:a.flowName,source:U,value:le});else if(le>0&&a._depth>0){var K=Re(a);K&&(R[K]||(R[K]=!0,P==null||P.push({name:K,depth:a._depth-1})),m==null||m.push({target:a.flowName,source:K,value:le}))}})}}return{generalInfo:I,carbonResult:c,chartData:v}},[z]),k=re.generalInfo,fe=re.carbonResult,he=re.chartData,ve=function(){var I=f()(u()().mark(function D(){var c,v,_,F,r;return u()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!(!y.get("id")||ne)){p.next=2;break}return p.abrupt("return",!1);case 2:return ce(!0),p.next=5,(0,h.LW)(y.get("id"));case 5:c=p.sent,c.headers&&(v=c.headers.get("content-disposition"),v&&(_=v.match(/filename=(.+)/),_&&(ce(!1),F=new Blob([c.data]),r=document.createElement("a"),r.download=_[1],r.style.display="none",r.href=URL.createObjectURL(F),document.body.appendChild(r),r.click(),URL.revokeObjectURL(r.href),document.body.removeChild(r))));case 7:case"end":return p.stop()}},D)}));return function(){return I.apply(this,arguments)}}();return(0,n.jsx)(b.Z,{title:"\u78B3\u8DB3\u8FF9\u7ED3\u679C",className:"text-lg text-black",extra:[(0,n.jsx)(A.u,{onClick:ve,className:"hidden",busy:ne,children:"\u5C06\u6B64\u9875\u9762\u751F\u6210PDF"},"key_export_pdf"),(0,n.jsx)(A.u,{onClick:ve,className:"min-w-[100px]",busy:ne,children:"\u5BFC\u51FA\u8BA1\u7B97\u660E\u7EC6Excel"},"key_export_excel")],children:Be?(0,n.jsx)("div",{className:"h-[100vh] w-full items-center",children:(0,n.jsx)(T.g,{})}):(0,n.jsx)("div",{className:"mo:break-all",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-5 mo:grid-cols-1",children:[(0,n.jsx)(q,{tit:"\u4EA7\u54C1\u78B3\u8DB3\u8FF9",children:(0,n.jsxs)("div",{className:"flex items-center flex-1 px-9 mb-9",children:[(0,n.jsx)(l.vD,{}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col justify-center items-center whitespace-nowrap",children:[(0,n.jsx)("span",{className:"font-semibold text-green-2 text-4xl",children:fe[0]}),(0,n.jsx)("span",{className:"font-semibold text-black text-base",children:fe[1]})]})]})}),(0,n.jsx)(q,{tit:"\u78B3\u8DB3\u8FF9\u8BC4\u4EF7\u8BE6\u60C5",children:(0,n.jsxs)("div",{className:"flex flex-col gap-3 mx-5 mt-3 mb-9",children:[(0,n.jsx)(L,{tit:"\u76EE\u6807\u4EA7\u54C1",value:k.targetName}),(0,n.jsx)(L,{tit:"\u76EE\u6807\u4EA7\u54C1\u6570\u91CF",value:k.targetAmount}),(0,n.jsx)(L,{tit:"\u78B3\u8DB3\u8FF9\u6279\u6B21",value:k.loadName}),(0,n.jsx)(L,{tit:"\u73AF\u5883\u5F71\u54CD\u8BC4\u4EF7\u65B9\u6CD5",value:"IPCC 2021,GWP 100"}),(0,n.jsx)(L,{tit:"\u8BA1\u7B97\u7ED3\u679C\u751F\u6210\u65F6\u95F4",value:k.calculateSuccessTime})]})}),(0,n.jsx)(q,{tit:"\u751F\u547D\u5468\u671F\u73AF\u8282\u660E\u7EC6\u7ED3\u679C",className:"col-span-2 mo:col-span-1",children:he&&(0,n.jsx)(C,{className:"w-full !h-[360px]",option:he})})]})})})}var be=xe,je=be}}]);
